<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>The Good Loser – Analysis of Conjoint Experiment</title>
  <meta name="description" content="The Good Loser – Analysis of Conjoint Experiment">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="The Good Loser – Analysis of Conjoint Experiment" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="The Good Loser – Analysis of Conjoint Experiment" />
  
  
  

<meta name="author" content="Sveinung Arnesen">


<meta name="date" content="2019-01-02">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="create-data-set.html">
<link rel="next" href="methods.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-1.3/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.5/datatables.js"></script>
<link href="libs/dt-core-1.10.16/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.16/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.16/js/jquery.dataTables.min.js"></script>
<script src="libs/jszip-1.10.16/jszip.min.js"></script>
<script src="libs/pdfmake-1.10.16/pdfmake.min.js"></script>
<script src="libs/pdfmake-1.10.16/vfs_fonts.js"></script>
<link href="libs/dt-ext-buttons-1.10.16/css/buttons.dataTables.min.css" rel="stylesheet" />
<script src="libs/dt-ext-buttons-1.10.16/js/dataTables.buttons.min.js"></script>
<script src="libs/dt-ext-buttons-1.10.16/js/buttons.flash.min.js"></script>
<script src="libs/dt-ext-buttons-1.10.16/js/buttons.html5.min.js"></script>
<script src="libs/dt-ext-buttons-1.10.16/js/buttons.colVis.min.js"></script>
<script src="libs/dt-ext-buttons-1.10.16/js/buttons.print.min.js"></script>
<link href="libs/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet" />
<script src="libs/nouislider-7.0.10/jquery.nouislider.min.js"></script>
<link href="libs/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet" />
<script src="libs/selectize-0.12.0/selectize.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">The Good Loser Project</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preface</a></li>
<li class="chapter" data-level="2" data-path="create-data-set.html"><a href="create-data-set.html"><i class="fa fa-check"></i><b>2</b> Create Data Set</a><ul>
<li class="chapter" data-level="2.1" data-path="create-data-set.html"><a href="create-data-set.html#load-raw-data"><i class="fa fa-check"></i><b>2.1</b> Load raw data</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="descriptive-statistics-of-data-set.html"><a href="descriptive-statistics-of-data-set.html"><i class="fa fa-check"></i><b>3</b> Descriptive Statistics of data set</a><ul>
<li class="chapter" data-level="3.1" data-path="descriptive-statistics-of-data-set.html"><a href="descriptive-statistics-of-data-set.html#items"><i class="fa fa-check"></i><b>3.1</b> Items</a><ul>
<li class="chapter" data-level="3.1.1" data-path="descriptive-statistics-of-data-set.html"><a href="descriptive-statistics-of-data-set.html#r13pad1"><i class="fa fa-check"></i><b>3.1.1</b> r13pad1</a></li>
<li class="chapter" data-level="3.1.2" data-path="descriptive-statistics-of-data-set.html"><a href="descriptive-statistics-of-data-set.html#r13pad2"><i class="fa fa-check"></i><b>3.1.2</b> r13pad2</a></li>
<li class="chapter" data-level="3.1.3" data-path="descriptive-statistics-of-data-set.html"><a href="descriptive-statistics-of-data-set.html#r13pad3"><i class="fa fa-check"></i><b>3.1.3</b> r13pad3</a></li>
<li class="chapter" data-level="3.1.4" data-path="descriptive-statistics-of-data-set.html"><a href="descriptive-statistics-of-data-set.html#r13pad4"><i class="fa fa-check"></i><b>3.1.4</b> r13pad4</a></li>
<li class="chapter" data-level="3.1.5" data-path="descriptive-statistics-of-data-set.html"><a href="descriptive-statistics-of-data-set.html#r13pad5_avsender"><i class="fa fa-check"></i><b>3.1.5</b> r13pad5_avsender</a></li>
<li class="chapter" data-level="3.1.6" data-path="descriptive-statistics-of-data-set.html"><a href="descriptive-statistics-of-data-set.html#r13pad5_sak"><i class="fa fa-check"></i><b>3.1.6</b> r13pad5_sak</a></li>
<li class="chapter" data-level="3.1.7" data-path="descriptive-statistics-of-data-set.html"><a href="descriptive-statistics-of-data-set.html#r13pad5_utfall"><i class="fa fa-check"></i><b>3.1.7</b> r13pad5_utfall</a></li>
<li class="chapter" data-level="3.1.8" data-path="descriptive-statistics-of-data-set.html"><a href="descriptive-statistics-of-data-set.html#r13pad5_vinner"><i class="fa fa-check"></i><b>3.1.8</b> r13pad5_vinner</a></li>
<li class="chapter" data-level="3.1.9" data-path="descriptive-statistics-of-data-set.html"><a href="descriptive-statistics-of-data-set.html#r13pad5_vinnermargin"><i class="fa fa-check"></i><b>3.1.9</b> r13pad5_vinnermargin</a></li>
<li class="chapter" data-level="3.1.10" data-path="descriptive-statistics-of-data-set.html"><a href="descriptive-statistics-of-data-set.html#r13pad6_ran"><i class="fa fa-check"></i><b>3.1.10</b> r13pad6_ran</a></li>
<li class="chapter" data-level="3.1.11" data-path="descriptive-statistics-of-data-set.html"><a href="descriptive-statistics-of-data-set.html#r13pad6a"><i class="fa fa-check"></i><b>3.1.11</b> r13pad6a</a></li>
<li class="chapter" data-level="3.1.12" data-path="descriptive-statistics-of-data-set.html"><a href="descriptive-statistics-of-data-set.html#r13pad6b"><i class="fa fa-check"></i><b>3.1.12</b> r13pad6b</a></li>
<li class="chapter" data-level="3.1.13" data-path="descriptive-statistics-of-data-set.html"><a href="descriptive-statistics-of-data-set.html#r13pad7a"><i class="fa fa-check"></i><b>3.1.13</b> r13pad7a</a></li>
<li class="chapter" data-level="3.1.14" data-path="descriptive-statistics-of-data-set.html"><a href="descriptive-statistics-of-data-set.html#r13pad7b"><i class="fa fa-check"></i><b>3.1.14</b> r13pad7b</a></li>
<li class="chapter" data-level="3.1.15" data-path="descriptive-statistics-of-data-set.html"><a href="descriptive-statistics-of-data-set.html#r13pad8a"><i class="fa fa-check"></i><b>3.1.15</b> r13pad8a</a></li>
<li class="chapter" data-level="3.1.16" data-path="descriptive-statistics-of-data-set.html"><a href="descriptive-statistics-of-data-set.html#r13pad8b"><i class="fa fa-check"></i><b>3.1.16</b> r13pad8b</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="descriptive-statistics-of-data-set.html"><a href="descriptive-statistics-of-data-set.html#missingness-report"><i class="fa fa-check"></i><b>3.2</b> Missingness report</a></li>
<li class="chapter" data-level="3.3" data-path="descriptive-statistics-of-data-set.html"><a href="descriptive-statistics-of-data-set.html#codebook-table"><i class="fa fa-check"></i><b>3.3</b> Codebook table</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="methods.html"><a href="methods.html"><i class="fa fa-check"></i><b>4</b> Methods</a></li>
<li class="chapter" data-level="5" data-path="applications.html"><a href="applications.html"><i class="fa fa-check"></i><b>5</b> Applications</a><ul>
<li class="chapter" data-level="5.1" data-path="applications.html"><a href="applications.html#example-one"><i class="fa fa-check"></i><b>5.1</b> Example one</a></li>
<li class="chapter" data-level="5.2" data-path="applications.html"><a href="applications.html#example-two"><i class="fa fa-check"></i><b>5.2</b> Example two</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="final-words.html"><a href="final-words.html"><i class="fa fa-check"></i><b>6</b> Final Words</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">The Good Loser – Analysis of Conjoint Experiment</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="descriptive-statistics-of-data-set" class="section level1">
<h1><span class="header-section-number">Chapter 3</span> Descriptive Statistics of data set</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span>(<span class="op">!</span><span class="kw">require</span>(<span class="st">&quot;codebook&quot;</span>)){<span class="kw">install.packages</span>(<span class="st">&quot;codebook&quot;</span>);  <span class="kw">library</span>(codebook)}</code></pre></div>
<pre><code>## Loading required package: codebook</code></pre>
<pre><code>## Warning: package &#39;codebook&#39; was built under R version 3.5.1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span>(<span class="op">!</span><span class="kw">require</span>(<span class="st">&quot;haven&quot;</span>)){<span class="kw">install.packages</span>(<span class="st">&quot;haven&quot;</span>);  <span class="kw">library</span>(haven)}
<span class="cf">if</span>(<span class="op">!</span><span class="kw">require</span>(<span class="st">&quot;knitr&quot;</span>)){<span class="kw">install.packages</span>(<span class="st">&quot;knitr&quot;</span>);  <span class="kw">library</span>(knitr)}
<span class="cf">if</span>(<span class="op">!</span><span class="kw">require</span>(<span class="st">&quot;kableExtra&quot;</span>)){<span class="kw">install.packages</span>(<span class="st">&quot;kableExtra&quot;</span>);  <span class="kw">library</span>(kableExtra)}
<span class="cf">if</span>(<span class="op">!</span><span class="kw">require</span>(<span class="st">&quot;openxlsx&quot;</span>)){<span class="kw">install.packages</span>(<span class="st">&quot;openxlsx&quot;</span>);  <span class="kw">library</span>(openxlsx)}</code></pre></div>
<pre><code>## Loading required package: openxlsx</code></pre>
<pre><code>## Warning: package &#39;openxlsx&#39; was built under R version 3.5.1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span>(<span class="op">!</span><span class="kw">require</span>(<span class="st">&quot;tidyverse&quot;</span>)){<span class="kw">install.packages</span>(<span class="st">&quot;tidyverse&quot;</span>);  <span class="kw">library</span>(tidyverse)}
<span class="cf">if</span>(<span class="op">!</span><span class="kw">require</span>(<span class="st">&quot;dplyr&quot;</span>)){<span class="kw">install.packages</span>(<span class="st">&quot;dplyr&quot;</span>);  <span class="kw">library</span>(dplyr)}


knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">echo =</span> <span class="ot">TRUE</span>, <span class="dt">knitr.kable.NA =</span> <span class="st">&quot;&quot;</span>, <span class="dt">cache =</span> <span class="ot">FALSE</span>)</code></pre></div>
<pre><code>## Warning in codebook(d): The variables session, created, ended have to
## be defined for automatic survey repetition detection to work. Set to no
## repetition by default.</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">knitr<span class="op">::</span><span class="kw">asis_output</span>(survey_overview)</code></pre></div>
<div id="items" class="section level2">
<h2><span class="header-section-number">3.1</span> Items</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">knitr<span class="op">::</span><span class="kw">asis_output</span>(<span class="kw">paste0</span>(scales_items, <span class="dt">sep =</span> <span class="st">&quot;</span><span class="ch">\n\n\n</span><span class="st">&quot;</span>, <span class="dt">collapse =</span> <span class="st">&quot;</span><span class="ch">\n\n\n</span><span class="st">&quot;</span>))</code></pre></div>
<div id="r13pad1" class="section level3 tabset">
<h3><span class="header-section-number">3.1.1</span> r13pad1</h3>
<div id="r13pad1_distribution" class="section level4">
<h4><span class="header-section-number">3.1.1.1</span> Distribution</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">show_missings &lt;-<span class="st"> </span><span class="ot">FALSE</span>
<span class="cf">if</span> (<span class="kw">has_label</span>(item)) {
  missings &lt;-<span class="st"> </span>item[<span class="kw">is.na</span>(haven<span class="op">::</span><span class="kw">zap_missing</span>(item))]
  <span class="kw">attributes</span>(missings) &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)
  <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(<span class="kw">attributes</span>(item)<span class="op">$</span>labels)) {
    <span class="kw">attributes</span>(missings)<span class="op">$</span>labels &lt;-<span class="st"> </span><span class="kw">attributes</span>(missings)<span class="op">$</span>labels[<span class="kw">is.na</span>(<span class="kw">attributes</span>(missings)<span class="op">$</span>labels)]
    <span class="kw">attributes</span>(item)<span class="op">$</span>labels &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)<span class="op">$</span>labels[<span class="op">!</span><span class="kw">is.na</span>(<span class="kw">attributes</span>(item)<span class="op">$</span>labels)]
  }
  <span class="cf">if</span> (<span class="kw">is.numeric</span>(item)) {
    show_missings &lt;-<span class="st"> </span><span class="kw">length</span>(<span class="kw">unique</span>(haven<span class="op">::</span><span class="kw">na_tag</span>(missings))) <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>
    item &lt;-<span class="st"> </span>haven<span class="op">::</span><span class="kw">zap_missing</span>(item)
  }
  <span class="cf">if</span> (<span class="kw">length</span>(item_attributes<span class="op">$</span>labels) <span class="op">==</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">is.numeric</span>(item)) {
    item &lt;-<span class="st"> </span>haven<span class="op">::</span><span class="kw">zap_labels</span>(item)
  }
}
item_nomiss &lt;-<span class="st"> </span>item[<span class="op">!</span><span class="kw">is.na</span>(item)]

<span class="co"># unnest mc_multiple and so on</span>
<span class="cf">if</span> (
  <span class="kw">is.character</span>(item_nomiss) <span class="op">&amp;&amp;</span>
<span class="st">  </span>stringr<span class="op">::</span><span class="kw">str_detect</span>(item_nomiss, stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;, &quot;</span>)) <span class="op">&amp;&amp;</span>
<span class="st">  </span>(<span class="kw">exists</span>(<span class="st">&quot;type&quot;</span>, item_info) <span class="op">&amp;&amp;</span><span class="st"> </span>
<span class="st">    </span>stringr<span class="op">::</span><span class="kw">str_detect</span>(item_info<span class="op">$</span>type, <span class="dt">pattern =</span> stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;multiple&quot;</span>)))
  ) {
  item_nomiss &lt;-<span class="st"> </span><span class="kw">unlist</span>(stringr<span class="op">::</span><span class="kw">str_split</span>(item_nomiss, <span class="dt">pattern =</span> stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;, &quot;</span>)))
}
<span class="kw">attributes</span>(item_nomiss) &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)

old_height &lt;-<span class="st"> </span>knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;fig.height&quot;</span>)
non_missing_choices &lt;-<span class="st"> </span>item_attributes[[<span class="st">&quot;labels&quot;</span>]]
many_labels &lt;-<span class="st"> </span><span class="kw">length</span>(non_missing_choices) <span class="op">&gt;</span><span class="st"> </span><span class="dv">7</span>
go_vertical &lt;-<span class="st"> </span><span class="op">!</span><span class="kw">is.numeric</span>(item_nomiss) <span class="op">||</span><span class="st"> </span>many_labels
<span class="cf">if</span> ( go_vertical ) {
  <span class="co"># numeric items are plotted horizontally (because that&#39;s what usually expected)</span>
  <span class="co"># categorical items are plotted vertically because we can use the screen real estate better this way</span>

    <span class="cf">if</span> (<span class="kw">is.null</span>(choices) <span class="op">||</span><span class="st"> </span>
<span class="st">        </span>dplyr<span class="op">::</span><span class="kw">n_distinct</span>(item_nomiss) <span class="op">&gt;</span><span class="st"> </span><span class="kw">length</span>(non_missing_choices)) {
        non_missing_choices &lt;-<span class="st"> </span><span class="kw">unique</span>(item_nomiss)
        <span class="kw">names</span>(non_missing_choices) &lt;-<span class="st"> </span>non_missing_choices
    }
  choice_multiplier &lt;-<span class="st"> </span>old_height<span class="op">/</span><span class="fl">6.5</span>
    new_height &lt;-<span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>choice_multiplier <span class="op">*</span><span class="st"> </span><span class="kw">length</span>(non_missing_choices)
    new_height &lt;-<span class="st"> </span><span class="kw">ifelse</span>(new_height <span class="op">&gt;</span><span class="st"> </span><span class="dv">20</span>, <span class="dv">20</span>, new_height)
    new_height &lt;-<span class="st"> </span><span class="kw">ifelse</span>(new_height <span class="op">&lt;</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">1</span>, new_height)
    knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">fig.height =</span> new_height)
}

wrap_at &lt;-<span class="st"> </span>knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;fig.width&quot;</span>) <span class="op">*</span><span class="st"> </span><span class="dv">10</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># todo: if there are free-text choices mingled in with the pre-defined ones, don&#39;t show</span>
<span class="co"># todo: show rare items if they are pre-defined</span>
<span class="co"># todo: bin rare responses into &quot;other category&quot;</span>
<span class="cf">if</span> (<span class="op">!</span><span class="kw">length</span>(item_nomiss)) {
  <span class="kw">cat</span>(<span class="st">&quot;No non-missing values to show.&quot;</span>)
} <span class="cf">else</span> <span class="cf">if</span> (<span class="kw">is.numeric</span>(item_nomiss) <span class="op">||</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">n_distinct</span>(item_nomiss) <span class="op">&lt;</span><span class="st"> </span><span class="dv">20</span>) {
  <span class="kw">plot_labelled</span>(item_nomiss, item_name, wrap_at, go_vertical)
} <span class="cf">else</span> {
    <span class="kw">cat</span>(dplyr<span class="op">::</span><span class="kw">n_distinct</span>(item_nomiss), <span class="st">&quot; unique, categorical values, so not shown.&quot;</span>)
}</code></pre></div>
<p><img src="Bookdown-goodloser_files/figure-html/r13pad1_distribution-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">fig.height =</span> old_height)</code></pre></div>
<p>0 missings.</p>
</div>
<div id="r13pad1_summary" class="section level4">
<h4><span class="header-section-number">3.1.1.2</span> Summary statistics</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">attributes</span>(item) &lt;-<span class="st"> </span>item_attributes
df =<span class="st"> </span><span class="kw">data.frame</span>(item, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)
<span class="kw">names</span>(df) =<span class="st"> </span>html_item_name
<span class="kw">escaped_table</span>(<span class="kw">codebook_table</span>(df))</code></pre></div>
<pre><code>## Warning: Prefixing `UQS()` with the rlang namespace is deprecated as of rlang 0.3.0.
## Please use the non-prefixed form or `!!!` instead.
## 
##   # Bad:
##   rlang::expr(mean(rlang::UQS(args)))
## 
##   # Ok:
##   rlang::expr(mean(UQS(args)))
## 
##   # Good:
##   rlang::expr(mean(!!!args))
## 
## This warning is displayed once per session.</code></pre>
<table>
<thead>
<tr>
<th style="text-align:left;">
name
</th>
<th style="text-align:left;">
data_type
</th>
<th style="text-align:left;">
missing
</th>
<th style="text-align:left;">
complete
</th>
<th style="text-align:left;">
n
</th>
<th style="text-align:left;">
empty
</th>
<th style="text-align:left;">
n_unique
</th>
<th style="text-align:left;">
min
</th>
<th style="text-align:left;">
max
</th>
<th style="text-align:left;">
format.spss
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
r13pad1
</td>
<td style="text-align:left;">
character
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
2843
</td>
<td style="text-align:left;">
2843
</td>
<td style="text-align:left;">
2843
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
A2
</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (show_missings) {
  <span class="kw">plot_labelled</span>(missings, item_name, wrap_at)
}</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(item_info)) {
  <span class="co"># don&#39;t show choices again, if they&#39;re basically same thing as value labels</span>
  <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.null</span>(item_info<span class="op">$</span>choices) <span class="op">&amp;&amp;</span><span class="st"> </span>
<span class="st">    </span><span class="kw">all</span>(<span class="kw">names</span>(<span class="kw">na.omit</span>(choices)) <span class="op">==</span><span class="st"> </span>item_info<span class="op">$</span>choices) <span class="op">&amp;&amp;</span>
<span class="st">    </span><span class="kw">all</span>(<span class="kw">na.omit</span>(choices) <span class="op">==</span><span class="st"> </span><span class="kw">names</span>(item_info<span class="op">$</span>choices))) {
    item_info<span class="op">$</span>choices &lt;-<span class="st"> </span><span class="ot">NULL</span>
  }
  item_info<span class="op">$</span>label_parsed &lt;-<span class="st"> </span>
<span class="st">    </span>item_info<span class="op">$</span>choice_list &lt;-<span class="st"> </span>item_info<span class="op">$</span>study_id &lt;-<span class="st"> </span>item_info<span class="op">$</span>id &lt;-<span class="st"> </span><span class="ot">NULL</span>
  pander<span class="op">::</span><span class="kw">pander</span>(item_info)
}</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">length</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">length</span>(choices) <span class="op">&lt;</span><span class="st"> </span><span class="dv">30</span>) {
    pander<span class="op">::</span><span class="kw">pander</span>(<span class="kw">as.list</span>(choices))
}</code></pre></div>
</div>
</div>
<div id="r13pad2" class="section level3 tabset">
<h3><span class="header-section-number">3.1.2</span> r13pad2</h3>
<div id="r13pad2_distribution" class="section level4">
<h4><span class="header-section-number">3.1.2.1</span> Distribution</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">show_missings &lt;-<span class="st"> </span><span class="ot">FALSE</span>
<span class="cf">if</span> (<span class="kw">has_label</span>(item)) {
  missings &lt;-<span class="st"> </span>item[<span class="kw">is.na</span>(haven<span class="op">::</span><span class="kw">zap_missing</span>(item))]
  <span class="kw">attributes</span>(missings) &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)
  <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(<span class="kw">attributes</span>(item)<span class="op">$</span>labels)) {
    <span class="kw">attributes</span>(missings)<span class="op">$</span>labels &lt;-<span class="st"> </span><span class="kw">attributes</span>(missings)<span class="op">$</span>labels[<span class="kw">is.na</span>(<span class="kw">attributes</span>(missings)<span class="op">$</span>labels)]
    <span class="kw">attributes</span>(item)<span class="op">$</span>labels &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)<span class="op">$</span>labels[<span class="op">!</span><span class="kw">is.na</span>(<span class="kw">attributes</span>(item)<span class="op">$</span>labels)]
  }
  <span class="cf">if</span> (<span class="kw">is.numeric</span>(item)) {
    show_missings &lt;-<span class="st"> </span><span class="kw">length</span>(<span class="kw">unique</span>(haven<span class="op">::</span><span class="kw">na_tag</span>(missings))) <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>
    item &lt;-<span class="st"> </span>haven<span class="op">::</span><span class="kw">zap_missing</span>(item)
  }
  <span class="cf">if</span> (<span class="kw">length</span>(item_attributes<span class="op">$</span>labels) <span class="op">==</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">is.numeric</span>(item)) {
    item &lt;-<span class="st"> </span>haven<span class="op">::</span><span class="kw">zap_labels</span>(item)
  }
}
item_nomiss &lt;-<span class="st"> </span>item[<span class="op">!</span><span class="kw">is.na</span>(item)]

<span class="co"># unnest mc_multiple and so on</span>
<span class="cf">if</span> (
  <span class="kw">is.character</span>(item_nomiss) <span class="op">&amp;&amp;</span>
<span class="st">  </span>stringr<span class="op">::</span><span class="kw">str_detect</span>(item_nomiss, stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;, &quot;</span>)) <span class="op">&amp;&amp;</span>
<span class="st">  </span>(<span class="kw">exists</span>(<span class="st">&quot;type&quot;</span>, item_info) <span class="op">&amp;&amp;</span><span class="st"> </span>
<span class="st">    </span>stringr<span class="op">::</span><span class="kw">str_detect</span>(item_info<span class="op">$</span>type, <span class="dt">pattern =</span> stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;multiple&quot;</span>)))
  ) {
  item_nomiss &lt;-<span class="st"> </span><span class="kw">unlist</span>(stringr<span class="op">::</span><span class="kw">str_split</span>(item_nomiss, <span class="dt">pattern =</span> stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;, &quot;</span>)))
}
<span class="kw">attributes</span>(item_nomiss) &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)

old_height &lt;-<span class="st"> </span>knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;fig.height&quot;</span>)
non_missing_choices &lt;-<span class="st"> </span>item_attributes[[<span class="st">&quot;labels&quot;</span>]]
many_labels &lt;-<span class="st"> </span><span class="kw">length</span>(non_missing_choices) <span class="op">&gt;</span><span class="st"> </span><span class="dv">7</span>
go_vertical &lt;-<span class="st"> </span><span class="op">!</span><span class="kw">is.numeric</span>(item_nomiss) <span class="op">||</span><span class="st"> </span>many_labels
<span class="cf">if</span> ( go_vertical ) {
  <span class="co"># numeric items are plotted horizontally (because that&#39;s what usually expected)</span>
  <span class="co"># categorical items are plotted vertically because we can use the screen real estate better this way</span>

    <span class="cf">if</span> (<span class="kw">is.null</span>(choices) <span class="op">||</span><span class="st"> </span>
<span class="st">        </span>dplyr<span class="op">::</span><span class="kw">n_distinct</span>(item_nomiss) <span class="op">&gt;</span><span class="st"> </span><span class="kw">length</span>(non_missing_choices)) {
        non_missing_choices &lt;-<span class="st"> </span><span class="kw">unique</span>(item_nomiss)
        <span class="kw">names</span>(non_missing_choices) &lt;-<span class="st"> </span>non_missing_choices
    }
  choice_multiplier &lt;-<span class="st"> </span>old_height<span class="op">/</span><span class="fl">6.5</span>
    new_height &lt;-<span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>choice_multiplier <span class="op">*</span><span class="st"> </span><span class="kw">length</span>(non_missing_choices)
    new_height &lt;-<span class="st"> </span><span class="kw">ifelse</span>(new_height <span class="op">&gt;</span><span class="st"> </span><span class="dv">20</span>, <span class="dv">20</span>, new_height)
    new_height &lt;-<span class="st"> </span><span class="kw">ifelse</span>(new_height <span class="op">&lt;</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">1</span>, new_height)
    knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">fig.height =</span> new_height)
}

wrap_at &lt;-<span class="st"> </span>knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;fig.width&quot;</span>) <span class="op">*</span><span class="st"> </span><span class="dv">10</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># todo: if there are free-text choices mingled in with the pre-defined ones, don&#39;t show</span>
<span class="co"># todo: show rare items if they are pre-defined</span>
<span class="co"># todo: bin rare responses into &quot;other category&quot;</span>
<span class="cf">if</span> (<span class="op">!</span><span class="kw">length</span>(item_nomiss)) {
  <span class="kw">cat</span>(<span class="st">&quot;No non-missing values to show.&quot;</span>)
} <span class="cf">else</span> <span class="cf">if</span> (<span class="kw">is.numeric</span>(item_nomiss) <span class="op">||</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">n_distinct</span>(item_nomiss) <span class="op">&lt;</span><span class="st"> </span><span class="dv">20</span>) {
  <span class="kw">plot_labelled</span>(item_nomiss, item_name, wrap_at, go_vertical)
} <span class="cf">else</span> {
    <span class="kw">cat</span>(dplyr<span class="op">::</span><span class="kw">n_distinct</span>(item_nomiss), <span class="st">&quot; unique, categorical values, so not shown.&quot;</span>)
}</code></pre></div>
<p><img src="Bookdown-goodloser_files/figure-html/r13pad2_distribution-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">fig.height =</span> old_height)</code></pre></div>
<p>0 missings.</p>
</div>
<div id="r13pad2_summary" class="section level4">
<h4><span class="header-section-number">3.1.2.2</span> Summary statistics</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">attributes</span>(item) &lt;-<span class="st"> </span>item_attributes
df =<span class="st"> </span><span class="kw">data.frame</span>(item, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)
<span class="kw">names</span>(df) =<span class="st"> </span>html_item_name
<span class="kw">escaped_table</span>(<span class="kw">codebook_table</span>(df))</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
name
</th>
<th style="text-align:left;">
data_type
</th>
<th style="text-align:left;">
missing
</th>
<th style="text-align:left;">
complete
</th>
<th style="text-align:left;">
n
</th>
<th style="text-align:left;">
mean
</th>
<th style="text-align:left;">
sd
</th>
<th style="text-align:left;">
p0
</th>
<th style="text-align:left;">
p25
</th>
<th style="text-align:left;">
p50
</th>
<th style="text-align:left;">
p75
</th>
<th style="text-align:left;">
p100
</th>
<th style="text-align:left;">
hist
</th>
<th style="text-align:left;">
format.spss
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
r13pad2
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
2843
</td>
<td style="text-align:left;">
2843
</td>
<td style="text-align:left;">
2.45
</td>
<td style="text-align:left;">
5.91
</td>
<td style="text-align:left;">
-91
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
5
</td>
<td style="text-align:left;">
▁▁▁▁▁▁▁▇
</td>
<td style="text-align:left;">
F8.2
</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (show_missings) {
  <span class="kw">plot_labelled</span>(missings, item_name, wrap_at)
}</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(item_info)) {
  <span class="co"># don&#39;t show choices again, if they&#39;re basically same thing as value labels</span>
  <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.null</span>(item_info<span class="op">$</span>choices) <span class="op">&amp;&amp;</span><span class="st"> </span>
<span class="st">    </span><span class="kw">all</span>(<span class="kw">names</span>(<span class="kw">na.omit</span>(choices)) <span class="op">==</span><span class="st"> </span>item_info<span class="op">$</span>choices) <span class="op">&amp;&amp;</span>
<span class="st">    </span><span class="kw">all</span>(<span class="kw">na.omit</span>(choices) <span class="op">==</span><span class="st"> </span><span class="kw">names</span>(item_info<span class="op">$</span>choices))) {
    item_info<span class="op">$</span>choices &lt;-<span class="st"> </span><span class="ot">NULL</span>
  }
  item_info<span class="op">$</span>label_parsed &lt;-<span class="st"> </span>
<span class="st">    </span>item_info<span class="op">$</span>choice_list &lt;-<span class="st"> </span>item_info<span class="op">$</span>study_id &lt;-<span class="st"> </span>item_info<span class="op">$</span>id &lt;-<span class="st"> </span><span class="ot">NULL</span>
  pander<span class="op">::</span><span class="kw">pander</span>(item_info)
}</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">length</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">length</span>(choices) <span class="op">&lt;</span><span class="st"> </span><span class="dv">30</span>) {
    pander<span class="op">::</span><span class="kw">pander</span>(<span class="kw">as.list</span>(choices))
}</code></pre></div>
</div>
</div>
<div id="r13pad3" class="section level3 tabset">
<h3><span class="header-section-number">3.1.3</span> r13pad3</h3>
<div id="r13pad3_distribution" class="section level4">
<h4><span class="header-section-number">3.1.3.1</span> Distribution</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">show_missings &lt;-<span class="st"> </span><span class="ot">FALSE</span>
<span class="cf">if</span> (<span class="kw">has_label</span>(item)) {
  missings &lt;-<span class="st"> </span>item[<span class="kw">is.na</span>(haven<span class="op">::</span><span class="kw">zap_missing</span>(item))]
  <span class="kw">attributes</span>(missings) &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)
  <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(<span class="kw">attributes</span>(item)<span class="op">$</span>labels)) {
    <span class="kw">attributes</span>(missings)<span class="op">$</span>labels &lt;-<span class="st"> </span><span class="kw">attributes</span>(missings)<span class="op">$</span>labels[<span class="kw">is.na</span>(<span class="kw">attributes</span>(missings)<span class="op">$</span>labels)]
    <span class="kw">attributes</span>(item)<span class="op">$</span>labels &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)<span class="op">$</span>labels[<span class="op">!</span><span class="kw">is.na</span>(<span class="kw">attributes</span>(item)<span class="op">$</span>labels)]
  }
  <span class="cf">if</span> (<span class="kw">is.numeric</span>(item)) {
    show_missings &lt;-<span class="st"> </span><span class="kw">length</span>(<span class="kw">unique</span>(haven<span class="op">::</span><span class="kw">na_tag</span>(missings))) <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>
    item &lt;-<span class="st"> </span>haven<span class="op">::</span><span class="kw">zap_missing</span>(item)
  }
  <span class="cf">if</span> (<span class="kw">length</span>(item_attributes<span class="op">$</span>labels) <span class="op">==</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">is.numeric</span>(item)) {
    item &lt;-<span class="st"> </span>haven<span class="op">::</span><span class="kw">zap_labels</span>(item)
  }
}
item_nomiss &lt;-<span class="st"> </span>item[<span class="op">!</span><span class="kw">is.na</span>(item)]

<span class="co"># unnest mc_multiple and so on</span>
<span class="cf">if</span> (
  <span class="kw">is.character</span>(item_nomiss) <span class="op">&amp;&amp;</span>
<span class="st">  </span>stringr<span class="op">::</span><span class="kw">str_detect</span>(item_nomiss, stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;, &quot;</span>)) <span class="op">&amp;&amp;</span>
<span class="st">  </span>(<span class="kw">exists</span>(<span class="st">&quot;type&quot;</span>, item_info) <span class="op">&amp;&amp;</span><span class="st"> </span>
<span class="st">    </span>stringr<span class="op">::</span><span class="kw">str_detect</span>(item_info<span class="op">$</span>type, <span class="dt">pattern =</span> stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;multiple&quot;</span>)))
  ) {
  item_nomiss &lt;-<span class="st"> </span><span class="kw">unlist</span>(stringr<span class="op">::</span><span class="kw">str_split</span>(item_nomiss, <span class="dt">pattern =</span> stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;, &quot;</span>)))
}
<span class="kw">attributes</span>(item_nomiss) &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)

old_height &lt;-<span class="st"> </span>knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;fig.height&quot;</span>)
non_missing_choices &lt;-<span class="st"> </span>item_attributes[[<span class="st">&quot;labels&quot;</span>]]
many_labels &lt;-<span class="st"> </span><span class="kw">length</span>(non_missing_choices) <span class="op">&gt;</span><span class="st"> </span><span class="dv">7</span>
go_vertical &lt;-<span class="st"> </span><span class="op">!</span><span class="kw">is.numeric</span>(item_nomiss) <span class="op">||</span><span class="st"> </span>many_labels
<span class="cf">if</span> ( go_vertical ) {
  <span class="co"># numeric items are plotted horizontally (because that&#39;s what usually expected)</span>
  <span class="co"># categorical items are plotted vertically because we can use the screen real estate better this way</span>

    <span class="cf">if</span> (<span class="kw">is.null</span>(choices) <span class="op">||</span><span class="st"> </span>
<span class="st">        </span>dplyr<span class="op">::</span><span class="kw">n_distinct</span>(item_nomiss) <span class="op">&gt;</span><span class="st"> </span><span class="kw">length</span>(non_missing_choices)) {
        non_missing_choices &lt;-<span class="st"> </span><span class="kw">unique</span>(item_nomiss)
        <span class="kw">names</span>(non_missing_choices) &lt;-<span class="st"> </span>non_missing_choices
    }
  choice_multiplier &lt;-<span class="st"> </span>old_height<span class="op">/</span><span class="fl">6.5</span>
    new_height &lt;-<span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>choice_multiplier <span class="op">*</span><span class="st"> </span><span class="kw">length</span>(non_missing_choices)
    new_height &lt;-<span class="st"> </span><span class="kw">ifelse</span>(new_height <span class="op">&gt;</span><span class="st"> </span><span class="dv">20</span>, <span class="dv">20</span>, new_height)
    new_height &lt;-<span class="st"> </span><span class="kw">ifelse</span>(new_height <span class="op">&lt;</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">1</span>, new_height)
    knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">fig.height =</span> new_height)
}

wrap_at &lt;-<span class="st"> </span>knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;fig.width&quot;</span>) <span class="op">*</span><span class="st"> </span><span class="dv">10</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># todo: if there are free-text choices mingled in with the pre-defined ones, don&#39;t show</span>
<span class="co"># todo: show rare items if they are pre-defined</span>
<span class="co"># todo: bin rare responses into &quot;other category&quot;</span>
<span class="cf">if</span> (<span class="op">!</span><span class="kw">length</span>(item_nomiss)) {
  <span class="kw">cat</span>(<span class="st">&quot;No non-missing values to show.&quot;</span>)
} <span class="cf">else</span> <span class="cf">if</span> (<span class="kw">is.numeric</span>(item_nomiss) <span class="op">||</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">n_distinct</span>(item_nomiss) <span class="op">&lt;</span><span class="st"> </span><span class="dv">20</span>) {
  <span class="kw">plot_labelled</span>(item_nomiss, item_name, wrap_at, go_vertical)
} <span class="cf">else</span> {
    <span class="kw">cat</span>(dplyr<span class="op">::</span><span class="kw">n_distinct</span>(item_nomiss), <span class="st">&quot; unique, categorical values, so not shown.&quot;</span>)
}</code></pre></div>
<p><img src="Bookdown-goodloser_files/figure-html/r13pad3_distribution-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">fig.height =</span> old_height)</code></pre></div>
<p>0 missings.</p>
</div>
<div id="r13pad3_summary" class="section level4">
<h4><span class="header-section-number">3.1.3.2</span> Summary statistics</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">attributes</span>(item) &lt;-<span class="st"> </span>item_attributes
df =<span class="st"> </span><span class="kw">data.frame</span>(item, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)
<span class="kw">names</span>(df) =<span class="st"> </span>html_item_name
<span class="kw">escaped_table</span>(<span class="kw">codebook_table</span>(df))</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
name
</th>
<th style="text-align:left;">
data_type
</th>
<th style="text-align:left;">
missing
</th>
<th style="text-align:left;">
complete
</th>
<th style="text-align:left;">
n
</th>
<th style="text-align:left;">
empty
</th>
<th style="text-align:left;">
n_unique
</th>
<th style="text-align:left;">
min
</th>
<th style="text-align:left;">
max
</th>
<th style="text-align:left;">
format.spss
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
r13pad3
</td>
<td style="text-align:left;">
character
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
2843
</td>
<td style="text-align:left;">
2843
</td>
<td style="text-align:left;">
2843
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
A2
</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (show_missings) {
  <span class="kw">plot_labelled</span>(missings, item_name, wrap_at)
}</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(item_info)) {
  <span class="co"># don&#39;t show choices again, if they&#39;re basically same thing as value labels</span>
  <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.null</span>(item_info<span class="op">$</span>choices) <span class="op">&amp;&amp;</span><span class="st"> </span>
<span class="st">    </span><span class="kw">all</span>(<span class="kw">names</span>(<span class="kw">na.omit</span>(choices)) <span class="op">==</span><span class="st"> </span>item_info<span class="op">$</span>choices) <span class="op">&amp;&amp;</span>
<span class="st">    </span><span class="kw">all</span>(<span class="kw">na.omit</span>(choices) <span class="op">==</span><span class="st"> </span><span class="kw">names</span>(item_info<span class="op">$</span>choices))) {
    item_info<span class="op">$</span>choices &lt;-<span class="st"> </span><span class="ot">NULL</span>
  }
  item_info<span class="op">$</span>label_parsed &lt;-<span class="st"> </span>
<span class="st">    </span>item_info<span class="op">$</span>choice_list &lt;-<span class="st"> </span>item_info<span class="op">$</span>study_id &lt;-<span class="st"> </span>item_info<span class="op">$</span>id &lt;-<span class="st"> </span><span class="ot">NULL</span>
  pander<span class="op">::</span><span class="kw">pander</span>(item_info)
}</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">length</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">length</span>(choices) <span class="op">&lt;</span><span class="st"> </span><span class="dv">30</span>) {
    pander<span class="op">::</span><span class="kw">pander</span>(<span class="kw">as.list</span>(choices))
}</code></pre></div>
</div>
</div>
<div id="r13pad4" class="section level3 tabset">
<h3><span class="header-section-number">3.1.4</span> r13pad4</h3>
<div id="r13pad4_distribution" class="section level4">
<h4><span class="header-section-number">3.1.4.1</span> Distribution</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">show_missings &lt;-<span class="st"> </span><span class="ot">FALSE</span>
<span class="cf">if</span> (<span class="kw">has_label</span>(item)) {
  missings &lt;-<span class="st"> </span>item[<span class="kw">is.na</span>(haven<span class="op">::</span><span class="kw">zap_missing</span>(item))]
  <span class="kw">attributes</span>(missings) &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)
  <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(<span class="kw">attributes</span>(item)<span class="op">$</span>labels)) {
    <span class="kw">attributes</span>(missings)<span class="op">$</span>labels &lt;-<span class="st"> </span><span class="kw">attributes</span>(missings)<span class="op">$</span>labels[<span class="kw">is.na</span>(<span class="kw">attributes</span>(missings)<span class="op">$</span>labels)]
    <span class="kw">attributes</span>(item)<span class="op">$</span>labels &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)<span class="op">$</span>labels[<span class="op">!</span><span class="kw">is.na</span>(<span class="kw">attributes</span>(item)<span class="op">$</span>labels)]
  }
  <span class="cf">if</span> (<span class="kw">is.numeric</span>(item)) {
    show_missings &lt;-<span class="st"> </span><span class="kw">length</span>(<span class="kw">unique</span>(haven<span class="op">::</span><span class="kw">na_tag</span>(missings))) <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>
    item &lt;-<span class="st"> </span>haven<span class="op">::</span><span class="kw">zap_missing</span>(item)
  }
  <span class="cf">if</span> (<span class="kw">length</span>(item_attributes<span class="op">$</span>labels) <span class="op">==</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">is.numeric</span>(item)) {
    item &lt;-<span class="st"> </span>haven<span class="op">::</span><span class="kw">zap_labels</span>(item)
  }
}
item_nomiss &lt;-<span class="st"> </span>item[<span class="op">!</span><span class="kw">is.na</span>(item)]

<span class="co"># unnest mc_multiple and so on</span>
<span class="cf">if</span> (
  <span class="kw">is.character</span>(item_nomiss) <span class="op">&amp;&amp;</span>
<span class="st">  </span>stringr<span class="op">::</span><span class="kw">str_detect</span>(item_nomiss, stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;, &quot;</span>)) <span class="op">&amp;&amp;</span>
<span class="st">  </span>(<span class="kw">exists</span>(<span class="st">&quot;type&quot;</span>, item_info) <span class="op">&amp;&amp;</span><span class="st"> </span>
<span class="st">    </span>stringr<span class="op">::</span><span class="kw">str_detect</span>(item_info<span class="op">$</span>type, <span class="dt">pattern =</span> stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;multiple&quot;</span>)))
  ) {
  item_nomiss &lt;-<span class="st"> </span><span class="kw">unlist</span>(stringr<span class="op">::</span><span class="kw">str_split</span>(item_nomiss, <span class="dt">pattern =</span> stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;, &quot;</span>)))
}
<span class="kw">attributes</span>(item_nomiss) &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)

old_height &lt;-<span class="st"> </span>knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;fig.height&quot;</span>)
non_missing_choices &lt;-<span class="st"> </span>item_attributes[[<span class="st">&quot;labels&quot;</span>]]
many_labels &lt;-<span class="st"> </span><span class="kw">length</span>(non_missing_choices) <span class="op">&gt;</span><span class="st"> </span><span class="dv">7</span>
go_vertical &lt;-<span class="st"> </span><span class="op">!</span><span class="kw">is.numeric</span>(item_nomiss) <span class="op">||</span><span class="st"> </span>many_labels
<span class="cf">if</span> ( go_vertical ) {
  <span class="co"># numeric items are plotted horizontally (because that&#39;s what usually expected)</span>
  <span class="co"># categorical items are plotted vertically because we can use the screen real estate better this way</span>

    <span class="cf">if</span> (<span class="kw">is.null</span>(choices) <span class="op">||</span><span class="st"> </span>
<span class="st">        </span>dplyr<span class="op">::</span><span class="kw">n_distinct</span>(item_nomiss) <span class="op">&gt;</span><span class="st"> </span><span class="kw">length</span>(non_missing_choices)) {
        non_missing_choices &lt;-<span class="st"> </span><span class="kw">unique</span>(item_nomiss)
        <span class="kw">names</span>(non_missing_choices) &lt;-<span class="st"> </span>non_missing_choices
    }
  choice_multiplier &lt;-<span class="st"> </span>old_height<span class="op">/</span><span class="fl">6.5</span>
    new_height &lt;-<span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>choice_multiplier <span class="op">*</span><span class="st"> </span><span class="kw">length</span>(non_missing_choices)
    new_height &lt;-<span class="st"> </span><span class="kw">ifelse</span>(new_height <span class="op">&gt;</span><span class="st"> </span><span class="dv">20</span>, <span class="dv">20</span>, new_height)
    new_height &lt;-<span class="st"> </span><span class="kw">ifelse</span>(new_height <span class="op">&lt;</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">1</span>, new_height)
    knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">fig.height =</span> new_height)
}

wrap_at &lt;-<span class="st"> </span>knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;fig.width&quot;</span>) <span class="op">*</span><span class="st"> </span><span class="dv">10</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># todo: if there are free-text choices mingled in with the pre-defined ones, don&#39;t show</span>
<span class="co"># todo: show rare items if they are pre-defined</span>
<span class="co"># todo: bin rare responses into &quot;other category&quot;</span>
<span class="cf">if</span> (<span class="op">!</span><span class="kw">length</span>(item_nomiss)) {
  <span class="kw">cat</span>(<span class="st">&quot;No non-missing values to show.&quot;</span>)
} <span class="cf">else</span> <span class="cf">if</span> (<span class="kw">is.numeric</span>(item_nomiss) <span class="op">||</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">n_distinct</span>(item_nomiss) <span class="op">&lt;</span><span class="st"> </span><span class="dv">20</span>) {
  <span class="kw">plot_labelled</span>(item_nomiss, item_name, wrap_at, go_vertical)
} <span class="cf">else</span> {
    <span class="kw">cat</span>(dplyr<span class="op">::</span><span class="kw">n_distinct</span>(item_nomiss), <span class="st">&quot; unique, categorical values, so not shown.&quot;</span>)
}</code></pre></div>
<p><img src="Bookdown-goodloser_files/figure-html/r13pad4_distribution-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">fig.height =</span> old_height)</code></pre></div>
<p>0 missings.</p>
</div>
<div id="r13pad4_summary" class="section level4">
<h4><span class="header-section-number">3.1.4.2</span> Summary statistics</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">attributes</span>(item) &lt;-<span class="st"> </span>item_attributes
df =<span class="st"> </span><span class="kw">data.frame</span>(item, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)
<span class="kw">names</span>(df) =<span class="st"> </span>html_item_name
<span class="kw">escaped_table</span>(<span class="kw">codebook_table</span>(df))</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
name
</th>
<th style="text-align:left;">
data_type
</th>
<th style="text-align:left;">
missing
</th>
<th style="text-align:left;">
complete
</th>
<th style="text-align:left;">
n
</th>
<th style="text-align:left;">
mean
</th>
<th style="text-align:left;">
sd
</th>
<th style="text-align:left;">
p0
</th>
<th style="text-align:left;">
p25
</th>
<th style="text-align:left;">
p50
</th>
<th style="text-align:left;">
p75
</th>
<th style="text-align:left;">
p100
</th>
<th style="text-align:left;">
hist
</th>
<th style="text-align:left;">
format.spss
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
r13pad4
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
2843
</td>
<td style="text-align:left;">
2843
</td>
<td style="text-align:left;">
2.76
</td>
<td style="text-align:left;">
6.93
</td>
<td style="text-align:left;">
-91
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
5
</td>
<td style="text-align:left;">
▁▁▁▁▁▁▁▇
</td>
<td style="text-align:left;">
F8.2
</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (show_missings) {
  <span class="kw">plot_labelled</span>(missings, item_name, wrap_at)
}</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(item_info)) {
  <span class="co"># don&#39;t show choices again, if they&#39;re basically same thing as value labels</span>
  <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.null</span>(item_info<span class="op">$</span>choices) <span class="op">&amp;&amp;</span><span class="st"> </span>
<span class="st">    </span><span class="kw">all</span>(<span class="kw">names</span>(<span class="kw">na.omit</span>(choices)) <span class="op">==</span><span class="st"> </span>item_info<span class="op">$</span>choices) <span class="op">&amp;&amp;</span>
<span class="st">    </span><span class="kw">all</span>(<span class="kw">na.omit</span>(choices) <span class="op">==</span><span class="st"> </span><span class="kw">names</span>(item_info<span class="op">$</span>choices))) {
    item_info<span class="op">$</span>choices &lt;-<span class="st"> </span><span class="ot">NULL</span>
  }
  item_info<span class="op">$</span>label_parsed &lt;-<span class="st"> </span>
<span class="st">    </span>item_info<span class="op">$</span>choice_list &lt;-<span class="st"> </span>item_info<span class="op">$</span>study_id &lt;-<span class="st"> </span>item_info<span class="op">$</span>id &lt;-<span class="st"> </span><span class="ot">NULL</span>
  pander<span class="op">::</span><span class="kw">pander</span>(item_info)
}</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">length</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">length</span>(choices) <span class="op">&lt;</span><span class="st"> </span><span class="dv">30</span>) {
    pander<span class="op">::</span><span class="kw">pander</span>(<span class="kw">as.list</span>(choices))
}</code></pre></div>
</div>
</div>
<div id="r13pad5_avsender" class="section level3 tabset">
<h3><span class="header-section-number">3.1.5</span> r13pad5_avsender</h3>
<div id="r13pad5_avsender_distribution" class="section level4">
<h4><span class="header-section-number">3.1.5.1</span> Distribution</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">show_missings &lt;-<span class="st"> </span><span class="ot">FALSE</span>
<span class="cf">if</span> (<span class="kw">has_label</span>(item)) {
  missings &lt;-<span class="st"> </span>item[<span class="kw">is.na</span>(haven<span class="op">::</span><span class="kw">zap_missing</span>(item))]
  <span class="kw">attributes</span>(missings) &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)
  <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(<span class="kw">attributes</span>(item)<span class="op">$</span>labels)) {
    <span class="kw">attributes</span>(missings)<span class="op">$</span>labels &lt;-<span class="st"> </span><span class="kw">attributes</span>(missings)<span class="op">$</span>labels[<span class="kw">is.na</span>(<span class="kw">attributes</span>(missings)<span class="op">$</span>labels)]
    <span class="kw">attributes</span>(item)<span class="op">$</span>labels &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)<span class="op">$</span>labels[<span class="op">!</span><span class="kw">is.na</span>(<span class="kw">attributes</span>(item)<span class="op">$</span>labels)]
  }
  <span class="cf">if</span> (<span class="kw">is.numeric</span>(item)) {
    show_missings &lt;-<span class="st"> </span><span class="kw">length</span>(<span class="kw">unique</span>(haven<span class="op">::</span><span class="kw">na_tag</span>(missings))) <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>
    item &lt;-<span class="st"> </span>haven<span class="op">::</span><span class="kw">zap_missing</span>(item)
  }
  <span class="cf">if</span> (<span class="kw">length</span>(item_attributes<span class="op">$</span>labels) <span class="op">==</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">is.numeric</span>(item)) {
    item &lt;-<span class="st"> </span>haven<span class="op">::</span><span class="kw">zap_labels</span>(item)
  }
}
item_nomiss &lt;-<span class="st"> </span>item[<span class="op">!</span><span class="kw">is.na</span>(item)]

<span class="co"># unnest mc_multiple and so on</span>
<span class="cf">if</span> (
  <span class="kw">is.character</span>(item_nomiss) <span class="op">&amp;&amp;</span>
<span class="st">  </span>stringr<span class="op">::</span><span class="kw">str_detect</span>(item_nomiss, stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;, &quot;</span>)) <span class="op">&amp;&amp;</span>
<span class="st">  </span>(<span class="kw">exists</span>(<span class="st">&quot;type&quot;</span>, item_info) <span class="op">&amp;&amp;</span><span class="st"> </span>
<span class="st">    </span>stringr<span class="op">::</span><span class="kw">str_detect</span>(item_info<span class="op">$</span>type, <span class="dt">pattern =</span> stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;multiple&quot;</span>)))
  ) {
  item_nomiss &lt;-<span class="st"> </span><span class="kw">unlist</span>(stringr<span class="op">::</span><span class="kw">str_split</span>(item_nomiss, <span class="dt">pattern =</span> stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;, &quot;</span>)))
}
<span class="kw">attributes</span>(item_nomiss) &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)

old_height &lt;-<span class="st"> </span>knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;fig.height&quot;</span>)
non_missing_choices &lt;-<span class="st"> </span>item_attributes[[<span class="st">&quot;labels&quot;</span>]]
many_labels &lt;-<span class="st"> </span><span class="kw">length</span>(non_missing_choices) <span class="op">&gt;</span><span class="st"> </span><span class="dv">7</span>
go_vertical &lt;-<span class="st"> </span><span class="op">!</span><span class="kw">is.numeric</span>(item_nomiss) <span class="op">||</span><span class="st"> </span>many_labels
<span class="cf">if</span> ( go_vertical ) {
  <span class="co"># numeric items are plotted horizontally (because that&#39;s what usually expected)</span>
  <span class="co"># categorical items are plotted vertically because we can use the screen real estate better this way</span>

    <span class="cf">if</span> (<span class="kw">is.null</span>(choices) <span class="op">||</span><span class="st"> </span>
<span class="st">        </span>dplyr<span class="op">::</span><span class="kw">n_distinct</span>(item_nomiss) <span class="op">&gt;</span><span class="st"> </span><span class="kw">length</span>(non_missing_choices)) {
        non_missing_choices &lt;-<span class="st"> </span><span class="kw">unique</span>(item_nomiss)
        <span class="kw">names</span>(non_missing_choices) &lt;-<span class="st"> </span>non_missing_choices
    }
  choice_multiplier &lt;-<span class="st"> </span>old_height<span class="op">/</span><span class="fl">6.5</span>
    new_height &lt;-<span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>choice_multiplier <span class="op">*</span><span class="st"> </span><span class="kw">length</span>(non_missing_choices)
    new_height &lt;-<span class="st"> </span><span class="kw">ifelse</span>(new_height <span class="op">&gt;</span><span class="st"> </span><span class="dv">20</span>, <span class="dv">20</span>, new_height)
    new_height &lt;-<span class="st"> </span><span class="kw">ifelse</span>(new_height <span class="op">&lt;</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">1</span>, new_height)
    knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">fig.height =</span> new_height)
}

wrap_at &lt;-<span class="st"> </span>knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;fig.width&quot;</span>) <span class="op">*</span><span class="st"> </span><span class="dv">10</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># todo: if there are free-text choices mingled in with the pre-defined ones, don&#39;t show</span>
<span class="co"># todo: show rare items if they are pre-defined</span>
<span class="co"># todo: bin rare responses into &quot;other category&quot;</span>
<span class="cf">if</span> (<span class="op">!</span><span class="kw">length</span>(item_nomiss)) {
  <span class="kw">cat</span>(<span class="st">&quot;No non-missing values to show.&quot;</span>)
} <span class="cf">else</span> <span class="cf">if</span> (<span class="kw">is.numeric</span>(item_nomiss) <span class="op">||</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">n_distinct</span>(item_nomiss) <span class="op">&lt;</span><span class="st"> </span><span class="dv">20</span>) {
  <span class="kw">plot_labelled</span>(item_nomiss, item_name, wrap_at, go_vertical)
} <span class="cf">else</span> {
    <span class="kw">cat</span>(dplyr<span class="op">::</span><span class="kw">n_distinct</span>(item_nomiss), <span class="st">&quot; unique, categorical values, so not shown.&quot;</span>)
}</code></pre></div>
<p><img src="Bookdown-goodloser_files/figure-html/r13pad5_avsender_distribution-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">fig.height =</span> old_height)</code></pre></div>
<p>0 missings.</p>
</div>
<div id="r13pad5_avsender_summary" class="section level4">
<h4><span class="header-section-number">3.1.5.2</span> Summary statistics</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">attributes</span>(item) &lt;-<span class="st"> </span>item_attributes
df =<span class="st"> </span><span class="kw">data.frame</span>(item, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)
<span class="kw">names</span>(df) =<span class="st"> </span>html_item_name
<span class="kw">escaped_table</span>(<span class="kw">codebook_table</span>(df))</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
name
</th>
<th style="text-align:left;">
data_type
</th>
<th style="text-align:left;">
missing
</th>
<th style="text-align:left;">
complete
</th>
<th style="text-align:left;">
n
</th>
<th style="text-align:left;">
mean
</th>
<th style="text-align:left;">
sd
</th>
<th style="text-align:left;">
p0
</th>
<th style="text-align:left;">
p25
</th>
<th style="text-align:left;">
p50
</th>
<th style="text-align:left;">
p75
</th>
<th style="text-align:left;">
p100
</th>
<th style="text-align:left;">
hist
</th>
<th style="text-align:left;">
format.spss
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
r13pad5_avsender
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
2843
</td>
<td style="text-align:left;">
2843
</td>
<td style="text-align:left;">
4.02
</td>
<td style="text-align:left;">
1.98
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
7
</td>
<td style="text-align:left;">
▇▇▇▇▁▇▇▇
</td>
<td style="text-align:left;">
F8.2
</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (show_missings) {
  <span class="kw">plot_labelled</span>(missings, item_name, wrap_at)
}</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(item_info)) {
  <span class="co"># don&#39;t show choices again, if they&#39;re basically same thing as value labels</span>
  <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.null</span>(item_info<span class="op">$</span>choices) <span class="op">&amp;&amp;</span><span class="st"> </span>
<span class="st">    </span><span class="kw">all</span>(<span class="kw">names</span>(<span class="kw">na.omit</span>(choices)) <span class="op">==</span><span class="st"> </span>item_info<span class="op">$</span>choices) <span class="op">&amp;&amp;</span>
<span class="st">    </span><span class="kw">all</span>(<span class="kw">na.omit</span>(choices) <span class="op">==</span><span class="st"> </span><span class="kw">names</span>(item_info<span class="op">$</span>choices))) {
    item_info<span class="op">$</span>choices &lt;-<span class="st"> </span><span class="ot">NULL</span>
  }
  item_info<span class="op">$</span>label_parsed &lt;-<span class="st"> </span>
<span class="st">    </span>item_info<span class="op">$</span>choice_list &lt;-<span class="st"> </span>item_info<span class="op">$</span>study_id &lt;-<span class="st"> </span>item_info<span class="op">$</span>id &lt;-<span class="st"> </span><span class="ot">NULL</span>
  pander<span class="op">::</span><span class="kw">pander</span>(item_info)
}</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">length</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">length</span>(choices) <span class="op">&lt;</span><span class="st"> </span><span class="dv">30</span>) {
    pander<span class="op">::</span><span class="kw">pander</span>(<span class="kw">as.list</span>(choices))
}</code></pre></div>
</div>
</div>
<div id="r13pad5_sak" class="section level3 tabset">
<h3><span class="header-section-number">3.1.6</span> r13pad5_sak</h3>
<div id="r13pad5_sak_distribution" class="section level4">
<h4><span class="header-section-number">3.1.6.1</span> Distribution</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">show_missings &lt;-<span class="st"> </span><span class="ot">FALSE</span>
<span class="cf">if</span> (<span class="kw">has_label</span>(item)) {
  missings &lt;-<span class="st"> </span>item[<span class="kw">is.na</span>(haven<span class="op">::</span><span class="kw">zap_missing</span>(item))]
  <span class="kw">attributes</span>(missings) &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)
  <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(<span class="kw">attributes</span>(item)<span class="op">$</span>labels)) {
    <span class="kw">attributes</span>(missings)<span class="op">$</span>labels &lt;-<span class="st"> </span><span class="kw">attributes</span>(missings)<span class="op">$</span>labels[<span class="kw">is.na</span>(<span class="kw">attributes</span>(missings)<span class="op">$</span>labels)]
    <span class="kw">attributes</span>(item)<span class="op">$</span>labels &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)<span class="op">$</span>labels[<span class="op">!</span><span class="kw">is.na</span>(<span class="kw">attributes</span>(item)<span class="op">$</span>labels)]
  }
  <span class="cf">if</span> (<span class="kw">is.numeric</span>(item)) {
    show_missings &lt;-<span class="st"> </span><span class="kw">length</span>(<span class="kw">unique</span>(haven<span class="op">::</span><span class="kw">na_tag</span>(missings))) <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>
    item &lt;-<span class="st"> </span>haven<span class="op">::</span><span class="kw">zap_missing</span>(item)
  }
  <span class="cf">if</span> (<span class="kw">length</span>(item_attributes<span class="op">$</span>labels) <span class="op">==</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">is.numeric</span>(item)) {
    item &lt;-<span class="st"> </span>haven<span class="op">::</span><span class="kw">zap_labels</span>(item)
  }
}
item_nomiss &lt;-<span class="st"> </span>item[<span class="op">!</span><span class="kw">is.na</span>(item)]

<span class="co"># unnest mc_multiple and so on</span>
<span class="cf">if</span> (
  <span class="kw">is.character</span>(item_nomiss) <span class="op">&amp;&amp;</span>
<span class="st">  </span>stringr<span class="op">::</span><span class="kw">str_detect</span>(item_nomiss, stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;, &quot;</span>)) <span class="op">&amp;&amp;</span>
<span class="st">  </span>(<span class="kw">exists</span>(<span class="st">&quot;type&quot;</span>, item_info) <span class="op">&amp;&amp;</span><span class="st"> </span>
<span class="st">    </span>stringr<span class="op">::</span><span class="kw">str_detect</span>(item_info<span class="op">$</span>type, <span class="dt">pattern =</span> stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;multiple&quot;</span>)))
  ) {
  item_nomiss &lt;-<span class="st"> </span><span class="kw">unlist</span>(stringr<span class="op">::</span><span class="kw">str_split</span>(item_nomiss, <span class="dt">pattern =</span> stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;, &quot;</span>)))
}
<span class="kw">attributes</span>(item_nomiss) &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)

old_height &lt;-<span class="st"> </span>knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;fig.height&quot;</span>)
non_missing_choices &lt;-<span class="st"> </span>item_attributes[[<span class="st">&quot;labels&quot;</span>]]
many_labels &lt;-<span class="st"> </span><span class="kw">length</span>(non_missing_choices) <span class="op">&gt;</span><span class="st"> </span><span class="dv">7</span>
go_vertical &lt;-<span class="st"> </span><span class="op">!</span><span class="kw">is.numeric</span>(item_nomiss) <span class="op">||</span><span class="st"> </span>many_labels
<span class="cf">if</span> ( go_vertical ) {
  <span class="co"># numeric items are plotted horizontally (because that&#39;s what usually expected)</span>
  <span class="co"># categorical items are plotted vertically because we can use the screen real estate better this way</span>

    <span class="cf">if</span> (<span class="kw">is.null</span>(choices) <span class="op">||</span><span class="st"> </span>
<span class="st">        </span>dplyr<span class="op">::</span><span class="kw">n_distinct</span>(item_nomiss) <span class="op">&gt;</span><span class="st"> </span><span class="kw">length</span>(non_missing_choices)) {
        non_missing_choices &lt;-<span class="st"> </span><span class="kw">unique</span>(item_nomiss)
        <span class="kw">names</span>(non_missing_choices) &lt;-<span class="st"> </span>non_missing_choices
    }
  choice_multiplier &lt;-<span class="st"> </span>old_height<span class="op">/</span><span class="fl">6.5</span>
    new_height &lt;-<span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>choice_multiplier <span class="op">*</span><span class="st"> </span><span class="kw">length</span>(non_missing_choices)
    new_height &lt;-<span class="st"> </span><span class="kw">ifelse</span>(new_height <span class="op">&gt;</span><span class="st"> </span><span class="dv">20</span>, <span class="dv">20</span>, new_height)
    new_height &lt;-<span class="st"> </span><span class="kw">ifelse</span>(new_height <span class="op">&lt;</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">1</span>, new_height)
    knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">fig.height =</span> new_height)
}

wrap_at &lt;-<span class="st"> </span>knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;fig.width&quot;</span>) <span class="op">*</span><span class="st"> </span><span class="dv">10</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># todo: if there are free-text choices mingled in with the pre-defined ones, don&#39;t show</span>
<span class="co"># todo: show rare items if they are pre-defined</span>
<span class="co"># todo: bin rare responses into &quot;other category&quot;</span>
<span class="cf">if</span> (<span class="op">!</span><span class="kw">length</span>(item_nomiss)) {
  <span class="kw">cat</span>(<span class="st">&quot;No non-missing values to show.&quot;</span>)
} <span class="cf">else</span> <span class="cf">if</span> (<span class="kw">is.numeric</span>(item_nomiss) <span class="op">||</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">n_distinct</span>(item_nomiss) <span class="op">&lt;</span><span class="st"> </span><span class="dv">20</span>) {
  <span class="kw">plot_labelled</span>(item_nomiss, item_name, wrap_at, go_vertical)
} <span class="cf">else</span> {
    <span class="kw">cat</span>(dplyr<span class="op">::</span><span class="kw">n_distinct</span>(item_nomiss), <span class="st">&quot; unique, categorical values, so not shown.&quot;</span>)
}</code></pre></div>
<p><img src="Bookdown-goodloser_files/figure-html/r13pad5_sak_distribution-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">fig.height =</span> old_height)</code></pre></div>
<p>0 missings.</p>
</div>
<div id="r13pad5_sak_summary" class="section level4">
<h4><span class="header-section-number">3.1.6.2</span> Summary statistics</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">attributes</span>(item) &lt;-<span class="st"> </span>item_attributes
df =<span class="st"> </span><span class="kw">data.frame</span>(item, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)
<span class="kw">names</span>(df) =<span class="st"> </span>html_item_name
<span class="kw">escaped_table</span>(<span class="kw">codebook_table</span>(df))</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
name
</th>
<th style="text-align:left;">
data_type
</th>
<th style="text-align:left;">
missing
</th>
<th style="text-align:left;">
complete
</th>
<th style="text-align:left;">
n
</th>
<th style="text-align:left;">
mean
</th>
<th style="text-align:left;">
sd
</th>
<th style="text-align:left;">
p0
</th>
<th style="text-align:left;">
p25
</th>
<th style="text-align:left;">
p50
</th>
<th style="text-align:left;">
p75
</th>
<th style="text-align:left;">
p100
</th>
<th style="text-align:left;">
hist
</th>
<th style="text-align:left;">
format.spss
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
r13pad5_sak
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
2843
</td>
<td style="text-align:left;">
2843
</td>
<td style="text-align:left;">
1.5
</td>
<td style="text-align:left;">
0.5
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
▇▁▁▁▁▁▁▇
</td>
<td style="text-align:left;">
F8.2
</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (show_missings) {
  <span class="kw">plot_labelled</span>(missings, item_name, wrap_at)
}</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(item_info)) {
  <span class="co"># don&#39;t show choices again, if they&#39;re basically same thing as value labels</span>
  <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.null</span>(item_info<span class="op">$</span>choices) <span class="op">&amp;&amp;</span><span class="st"> </span>
<span class="st">    </span><span class="kw">all</span>(<span class="kw">names</span>(<span class="kw">na.omit</span>(choices)) <span class="op">==</span><span class="st"> </span>item_info<span class="op">$</span>choices) <span class="op">&amp;&amp;</span>
<span class="st">    </span><span class="kw">all</span>(<span class="kw">na.omit</span>(choices) <span class="op">==</span><span class="st"> </span><span class="kw">names</span>(item_info<span class="op">$</span>choices))) {
    item_info<span class="op">$</span>choices &lt;-<span class="st"> </span><span class="ot">NULL</span>
  }
  item_info<span class="op">$</span>label_parsed &lt;-<span class="st"> </span>
<span class="st">    </span>item_info<span class="op">$</span>choice_list &lt;-<span class="st"> </span>item_info<span class="op">$</span>study_id &lt;-<span class="st"> </span>item_info<span class="op">$</span>id &lt;-<span class="st"> </span><span class="ot">NULL</span>
  pander<span class="op">::</span><span class="kw">pander</span>(item_info)
}</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">length</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">length</span>(choices) <span class="op">&lt;</span><span class="st"> </span><span class="dv">30</span>) {
    pander<span class="op">::</span><span class="kw">pander</span>(<span class="kw">as.list</span>(choices))
}</code></pre></div>
</div>
</div>
<div id="r13pad5_utfall" class="section level3 tabset">
<h3><span class="header-section-number">3.1.7</span> r13pad5_utfall</h3>
<div id="r13pad5_utfall_distribution" class="section level4">
<h4><span class="header-section-number">3.1.7.1</span> Distribution</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">show_missings &lt;-<span class="st"> </span><span class="ot">FALSE</span>
<span class="cf">if</span> (<span class="kw">has_label</span>(item)) {
  missings &lt;-<span class="st"> </span>item[<span class="kw">is.na</span>(haven<span class="op">::</span><span class="kw">zap_missing</span>(item))]
  <span class="kw">attributes</span>(missings) &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)
  <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(<span class="kw">attributes</span>(item)<span class="op">$</span>labels)) {
    <span class="kw">attributes</span>(missings)<span class="op">$</span>labels &lt;-<span class="st"> </span><span class="kw">attributes</span>(missings)<span class="op">$</span>labels[<span class="kw">is.na</span>(<span class="kw">attributes</span>(missings)<span class="op">$</span>labels)]
    <span class="kw">attributes</span>(item)<span class="op">$</span>labels &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)<span class="op">$</span>labels[<span class="op">!</span><span class="kw">is.na</span>(<span class="kw">attributes</span>(item)<span class="op">$</span>labels)]
  }
  <span class="cf">if</span> (<span class="kw">is.numeric</span>(item)) {
    show_missings &lt;-<span class="st"> </span><span class="kw">length</span>(<span class="kw">unique</span>(haven<span class="op">::</span><span class="kw">na_tag</span>(missings))) <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>
    item &lt;-<span class="st"> </span>haven<span class="op">::</span><span class="kw">zap_missing</span>(item)
  }
  <span class="cf">if</span> (<span class="kw">length</span>(item_attributes<span class="op">$</span>labels) <span class="op">==</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">is.numeric</span>(item)) {
    item &lt;-<span class="st"> </span>haven<span class="op">::</span><span class="kw">zap_labels</span>(item)
  }
}
item_nomiss &lt;-<span class="st"> </span>item[<span class="op">!</span><span class="kw">is.na</span>(item)]

<span class="co"># unnest mc_multiple and so on</span>
<span class="cf">if</span> (
  <span class="kw">is.character</span>(item_nomiss) <span class="op">&amp;&amp;</span>
<span class="st">  </span>stringr<span class="op">::</span><span class="kw">str_detect</span>(item_nomiss, stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;, &quot;</span>)) <span class="op">&amp;&amp;</span>
<span class="st">  </span>(<span class="kw">exists</span>(<span class="st">&quot;type&quot;</span>, item_info) <span class="op">&amp;&amp;</span><span class="st"> </span>
<span class="st">    </span>stringr<span class="op">::</span><span class="kw">str_detect</span>(item_info<span class="op">$</span>type, <span class="dt">pattern =</span> stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;multiple&quot;</span>)))
  ) {
  item_nomiss &lt;-<span class="st"> </span><span class="kw">unlist</span>(stringr<span class="op">::</span><span class="kw">str_split</span>(item_nomiss, <span class="dt">pattern =</span> stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;, &quot;</span>)))
}
<span class="kw">attributes</span>(item_nomiss) &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)

old_height &lt;-<span class="st"> </span>knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;fig.height&quot;</span>)
non_missing_choices &lt;-<span class="st"> </span>item_attributes[[<span class="st">&quot;labels&quot;</span>]]
many_labels &lt;-<span class="st"> </span><span class="kw">length</span>(non_missing_choices) <span class="op">&gt;</span><span class="st"> </span><span class="dv">7</span>
go_vertical &lt;-<span class="st"> </span><span class="op">!</span><span class="kw">is.numeric</span>(item_nomiss) <span class="op">||</span><span class="st"> </span>many_labels
<span class="cf">if</span> ( go_vertical ) {
  <span class="co"># numeric items are plotted horizontally (because that&#39;s what usually expected)</span>
  <span class="co"># categorical items are plotted vertically because we can use the screen real estate better this way</span>

    <span class="cf">if</span> (<span class="kw">is.null</span>(choices) <span class="op">||</span><span class="st"> </span>
<span class="st">        </span>dplyr<span class="op">::</span><span class="kw">n_distinct</span>(item_nomiss) <span class="op">&gt;</span><span class="st"> </span><span class="kw">length</span>(non_missing_choices)) {
        non_missing_choices &lt;-<span class="st"> </span><span class="kw">unique</span>(item_nomiss)
        <span class="kw">names</span>(non_missing_choices) &lt;-<span class="st"> </span>non_missing_choices
    }
  choice_multiplier &lt;-<span class="st"> </span>old_height<span class="op">/</span><span class="fl">6.5</span>
    new_height &lt;-<span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>choice_multiplier <span class="op">*</span><span class="st"> </span><span class="kw">length</span>(non_missing_choices)
    new_height &lt;-<span class="st"> </span><span class="kw">ifelse</span>(new_height <span class="op">&gt;</span><span class="st"> </span><span class="dv">20</span>, <span class="dv">20</span>, new_height)
    new_height &lt;-<span class="st"> </span><span class="kw">ifelse</span>(new_height <span class="op">&lt;</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">1</span>, new_height)
    knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">fig.height =</span> new_height)
}

wrap_at &lt;-<span class="st"> </span>knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;fig.width&quot;</span>) <span class="op">*</span><span class="st"> </span><span class="dv">10</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># todo: if there are free-text choices mingled in with the pre-defined ones, don&#39;t show</span>
<span class="co"># todo: show rare items if they are pre-defined</span>
<span class="co"># todo: bin rare responses into &quot;other category&quot;</span>
<span class="cf">if</span> (<span class="op">!</span><span class="kw">length</span>(item_nomiss)) {
  <span class="kw">cat</span>(<span class="st">&quot;No non-missing values to show.&quot;</span>)
} <span class="cf">else</span> <span class="cf">if</span> (<span class="kw">is.numeric</span>(item_nomiss) <span class="op">||</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">n_distinct</span>(item_nomiss) <span class="op">&lt;</span><span class="st"> </span><span class="dv">20</span>) {
  <span class="kw">plot_labelled</span>(item_nomiss, item_name, wrap_at, go_vertical)
} <span class="cf">else</span> {
    <span class="kw">cat</span>(dplyr<span class="op">::</span><span class="kw">n_distinct</span>(item_nomiss), <span class="st">&quot; unique, categorical values, so not shown.&quot;</span>)
}</code></pre></div>
<p><img src="Bookdown-goodloser_files/figure-html/r13pad5_utfall_distribution-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">fig.height =</span> old_height)</code></pre></div>
<p>0 missings.</p>
</div>
<div id="r13pad5_utfall_summary" class="section level4">
<h4><span class="header-section-number">3.1.7.2</span> Summary statistics</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">attributes</span>(item) &lt;-<span class="st"> </span>item_attributes
df =<span class="st"> </span><span class="kw">data.frame</span>(item, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)
<span class="kw">names</span>(df) =<span class="st"> </span>html_item_name
<span class="kw">escaped_table</span>(<span class="kw">codebook_table</span>(df))</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
name
</th>
<th style="text-align:left;">
data_type
</th>
<th style="text-align:left;">
missing
</th>
<th style="text-align:left;">
complete
</th>
<th style="text-align:left;">
n
</th>
<th style="text-align:left;">
mean
</th>
<th style="text-align:left;">
sd
</th>
<th style="text-align:left;">
p0
</th>
<th style="text-align:left;">
p25
</th>
<th style="text-align:left;">
p50
</th>
<th style="text-align:left;">
p75
</th>
<th style="text-align:left;">
p100
</th>
<th style="text-align:left;">
hist
</th>
<th style="text-align:left;">
format.spss
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
r13pad5_utfall
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
2843
</td>
<td style="text-align:left;">
2843
</td>
<td style="text-align:left;">
1.5
</td>
<td style="text-align:left;">
0.5
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
▇▁▁▁▁▁▁▇
</td>
<td style="text-align:left;">
F8.2
</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (show_missings) {
  <span class="kw">plot_labelled</span>(missings, item_name, wrap_at)
}</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(item_info)) {
  <span class="co"># don&#39;t show choices again, if they&#39;re basically same thing as value labels</span>
  <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.null</span>(item_info<span class="op">$</span>choices) <span class="op">&amp;&amp;</span><span class="st"> </span>
<span class="st">    </span><span class="kw">all</span>(<span class="kw">names</span>(<span class="kw">na.omit</span>(choices)) <span class="op">==</span><span class="st"> </span>item_info<span class="op">$</span>choices) <span class="op">&amp;&amp;</span>
<span class="st">    </span><span class="kw">all</span>(<span class="kw">na.omit</span>(choices) <span class="op">==</span><span class="st"> </span><span class="kw">names</span>(item_info<span class="op">$</span>choices))) {
    item_info<span class="op">$</span>choices &lt;-<span class="st"> </span><span class="ot">NULL</span>
  }
  item_info<span class="op">$</span>label_parsed &lt;-<span class="st"> </span>
<span class="st">    </span>item_info<span class="op">$</span>choice_list &lt;-<span class="st"> </span>item_info<span class="op">$</span>study_id &lt;-<span class="st"> </span>item_info<span class="op">$</span>id &lt;-<span class="st"> </span><span class="ot">NULL</span>
  pander<span class="op">::</span><span class="kw">pander</span>(item_info)
}</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">length</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">length</span>(choices) <span class="op">&lt;</span><span class="st"> </span><span class="dv">30</span>) {
    pander<span class="op">::</span><span class="kw">pander</span>(<span class="kw">as.list</span>(choices))
}</code></pre></div>
</div>
</div>
<div id="r13pad5_vinner" class="section level3 tabset">
<h3><span class="header-section-number">3.1.8</span> r13pad5_vinner</h3>
<div id="r13pad5_vinner_distribution" class="section level4">
<h4><span class="header-section-number">3.1.8.1</span> Distribution</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">show_missings &lt;-<span class="st"> </span><span class="ot">FALSE</span>
<span class="cf">if</span> (<span class="kw">has_label</span>(item)) {
  missings &lt;-<span class="st"> </span>item[<span class="kw">is.na</span>(haven<span class="op">::</span><span class="kw">zap_missing</span>(item))]
  <span class="kw">attributes</span>(missings) &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)
  <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(<span class="kw">attributes</span>(item)<span class="op">$</span>labels)) {
    <span class="kw">attributes</span>(missings)<span class="op">$</span>labels &lt;-<span class="st"> </span><span class="kw">attributes</span>(missings)<span class="op">$</span>labels[<span class="kw">is.na</span>(<span class="kw">attributes</span>(missings)<span class="op">$</span>labels)]
    <span class="kw">attributes</span>(item)<span class="op">$</span>labels &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)<span class="op">$</span>labels[<span class="op">!</span><span class="kw">is.na</span>(<span class="kw">attributes</span>(item)<span class="op">$</span>labels)]
  }
  <span class="cf">if</span> (<span class="kw">is.numeric</span>(item)) {
    show_missings &lt;-<span class="st"> </span><span class="kw">length</span>(<span class="kw">unique</span>(haven<span class="op">::</span><span class="kw">na_tag</span>(missings))) <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>
    item &lt;-<span class="st"> </span>haven<span class="op">::</span><span class="kw">zap_missing</span>(item)
  }
  <span class="cf">if</span> (<span class="kw">length</span>(item_attributes<span class="op">$</span>labels) <span class="op">==</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">is.numeric</span>(item)) {
    item &lt;-<span class="st"> </span>haven<span class="op">::</span><span class="kw">zap_labels</span>(item)
  }
}
item_nomiss &lt;-<span class="st"> </span>item[<span class="op">!</span><span class="kw">is.na</span>(item)]

<span class="co"># unnest mc_multiple and so on</span>
<span class="cf">if</span> (
  <span class="kw">is.character</span>(item_nomiss) <span class="op">&amp;&amp;</span>
<span class="st">  </span>stringr<span class="op">::</span><span class="kw">str_detect</span>(item_nomiss, stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;, &quot;</span>)) <span class="op">&amp;&amp;</span>
<span class="st">  </span>(<span class="kw">exists</span>(<span class="st">&quot;type&quot;</span>, item_info) <span class="op">&amp;&amp;</span><span class="st"> </span>
<span class="st">    </span>stringr<span class="op">::</span><span class="kw">str_detect</span>(item_info<span class="op">$</span>type, <span class="dt">pattern =</span> stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;multiple&quot;</span>)))
  ) {
  item_nomiss &lt;-<span class="st"> </span><span class="kw">unlist</span>(stringr<span class="op">::</span><span class="kw">str_split</span>(item_nomiss, <span class="dt">pattern =</span> stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;, &quot;</span>)))
}
<span class="kw">attributes</span>(item_nomiss) &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)

old_height &lt;-<span class="st"> </span>knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;fig.height&quot;</span>)
non_missing_choices &lt;-<span class="st"> </span>item_attributes[[<span class="st">&quot;labels&quot;</span>]]
many_labels &lt;-<span class="st"> </span><span class="kw">length</span>(non_missing_choices) <span class="op">&gt;</span><span class="st"> </span><span class="dv">7</span>
go_vertical &lt;-<span class="st"> </span><span class="op">!</span><span class="kw">is.numeric</span>(item_nomiss) <span class="op">||</span><span class="st"> </span>many_labels
<span class="cf">if</span> ( go_vertical ) {
  <span class="co"># numeric items are plotted horizontally (because that&#39;s what usually expected)</span>
  <span class="co"># categorical items are plotted vertically because we can use the screen real estate better this way</span>

    <span class="cf">if</span> (<span class="kw">is.null</span>(choices) <span class="op">||</span><span class="st"> </span>
<span class="st">        </span>dplyr<span class="op">::</span><span class="kw">n_distinct</span>(item_nomiss) <span class="op">&gt;</span><span class="st"> </span><span class="kw">length</span>(non_missing_choices)) {
        non_missing_choices &lt;-<span class="st"> </span><span class="kw">unique</span>(item_nomiss)
        <span class="kw">names</span>(non_missing_choices) &lt;-<span class="st"> </span>non_missing_choices
    }
  choice_multiplier &lt;-<span class="st"> </span>old_height<span class="op">/</span><span class="fl">6.5</span>
    new_height &lt;-<span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>choice_multiplier <span class="op">*</span><span class="st"> </span><span class="kw">length</span>(non_missing_choices)
    new_height &lt;-<span class="st"> </span><span class="kw">ifelse</span>(new_height <span class="op">&gt;</span><span class="st"> </span><span class="dv">20</span>, <span class="dv">20</span>, new_height)
    new_height &lt;-<span class="st"> </span><span class="kw">ifelse</span>(new_height <span class="op">&lt;</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">1</span>, new_height)
    knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">fig.height =</span> new_height)
}

wrap_at &lt;-<span class="st"> </span>knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;fig.width&quot;</span>) <span class="op">*</span><span class="st"> </span><span class="dv">10</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># todo: if there are free-text choices mingled in with the pre-defined ones, don&#39;t show</span>
<span class="co"># todo: show rare items if they are pre-defined</span>
<span class="co"># todo: bin rare responses into &quot;other category&quot;</span>
<span class="cf">if</span> (<span class="op">!</span><span class="kw">length</span>(item_nomiss)) {
  <span class="kw">cat</span>(<span class="st">&quot;No non-missing values to show.&quot;</span>)
} <span class="cf">else</span> <span class="cf">if</span> (<span class="kw">is.numeric</span>(item_nomiss) <span class="op">||</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">n_distinct</span>(item_nomiss) <span class="op">&lt;</span><span class="st"> </span><span class="dv">20</span>) {
  <span class="kw">plot_labelled</span>(item_nomiss, item_name, wrap_at, go_vertical)
} <span class="cf">else</span> {
    <span class="kw">cat</span>(dplyr<span class="op">::</span><span class="kw">n_distinct</span>(item_nomiss), <span class="st">&quot; unique, categorical values, so not shown.&quot;</span>)
}</code></pre></div>
<p><img src="Bookdown-goodloser_files/figure-html/r13pad5_vinner_distribution-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">fig.height =</span> old_height)</code></pre></div>
<p>0 missings.</p>
</div>
<div id="r13pad5_vinner_summary" class="section level4">
<h4><span class="header-section-number">3.1.8.2</span> Summary statistics</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">attributes</span>(item) &lt;-<span class="st"> </span>item_attributes
df =<span class="st"> </span><span class="kw">data.frame</span>(item, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)
<span class="kw">names</span>(df) =<span class="st"> </span>html_item_name
<span class="kw">escaped_table</span>(<span class="kw">codebook_table</span>(df))</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
name
</th>
<th style="text-align:left;">
data_type
</th>
<th style="text-align:left;">
missing
</th>
<th style="text-align:left;">
complete
</th>
<th style="text-align:left;">
n
</th>
<th style="text-align:left;">
mean
</th>
<th style="text-align:left;">
sd
</th>
<th style="text-align:left;">
p0
</th>
<th style="text-align:left;">
p25
</th>
<th style="text-align:left;">
p50
</th>
<th style="text-align:left;">
p75
</th>
<th style="text-align:left;">
p100
</th>
<th style="text-align:left;">
hist
</th>
<th style="text-align:left;">
format.spss
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
r13pad5_vinner
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
2843
</td>
<td style="text-align:left;">
2843
</td>
<td style="text-align:left;">
1.51
</td>
<td style="text-align:left;">
0.5
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
▇▁▁▁▁▁▁▇
</td>
<td style="text-align:left;">
F8.2
</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (show_missings) {
  <span class="kw">plot_labelled</span>(missings, item_name, wrap_at)
}</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(item_info)) {
  <span class="co"># don&#39;t show choices again, if they&#39;re basically same thing as value labels</span>
  <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.null</span>(item_info<span class="op">$</span>choices) <span class="op">&amp;&amp;</span><span class="st"> </span>
<span class="st">    </span><span class="kw">all</span>(<span class="kw">names</span>(<span class="kw">na.omit</span>(choices)) <span class="op">==</span><span class="st"> </span>item_info<span class="op">$</span>choices) <span class="op">&amp;&amp;</span>
<span class="st">    </span><span class="kw">all</span>(<span class="kw">na.omit</span>(choices) <span class="op">==</span><span class="st"> </span><span class="kw">names</span>(item_info<span class="op">$</span>choices))) {
    item_info<span class="op">$</span>choices &lt;-<span class="st"> </span><span class="ot">NULL</span>
  }
  item_info<span class="op">$</span>label_parsed &lt;-<span class="st"> </span>
<span class="st">    </span>item_info<span class="op">$</span>choice_list &lt;-<span class="st"> </span>item_info<span class="op">$</span>study_id &lt;-<span class="st"> </span>item_info<span class="op">$</span>id &lt;-<span class="st"> </span><span class="ot">NULL</span>
  pander<span class="op">::</span><span class="kw">pander</span>(item_info)
}</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">length</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">length</span>(choices) <span class="op">&lt;</span><span class="st"> </span><span class="dv">30</span>) {
    pander<span class="op">::</span><span class="kw">pander</span>(<span class="kw">as.list</span>(choices))
}</code></pre></div>
</div>
</div>
<div id="r13pad5_vinnermargin" class="section level3 tabset">
<h3><span class="header-section-number">3.1.9</span> r13pad5_vinnermargin</h3>
<div id="r13pad5_vinnermargin_distribution" class="section level4">
<h4><span class="header-section-number">3.1.9.1</span> Distribution</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">show_missings &lt;-<span class="st"> </span><span class="ot">FALSE</span>
<span class="cf">if</span> (<span class="kw">has_label</span>(item)) {
  missings &lt;-<span class="st"> </span>item[<span class="kw">is.na</span>(haven<span class="op">::</span><span class="kw">zap_missing</span>(item))]
  <span class="kw">attributes</span>(missings) &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)
  <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(<span class="kw">attributes</span>(item)<span class="op">$</span>labels)) {
    <span class="kw">attributes</span>(missings)<span class="op">$</span>labels &lt;-<span class="st"> </span><span class="kw">attributes</span>(missings)<span class="op">$</span>labels[<span class="kw">is.na</span>(<span class="kw">attributes</span>(missings)<span class="op">$</span>labels)]
    <span class="kw">attributes</span>(item)<span class="op">$</span>labels &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)<span class="op">$</span>labels[<span class="op">!</span><span class="kw">is.na</span>(<span class="kw">attributes</span>(item)<span class="op">$</span>labels)]
  }
  <span class="cf">if</span> (<span class="kw">is.numeric</span>(item)) {
    show_missings &lt;-<span class="st"> </span><span class="kw">length</span>(<span class="kw">unique</span>(haven<span class="op">::</span><span class="kw">na_tag</span>(missings))) <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>
    item &lt;-<span class="st"> </span>haven<span class="op">::</span><span class="kw">zap_missing</span>(item)
  }
  <span class="cf">if</span> (<span class="kw">length</span>(item_attributes<span class="op">$</span>labels) <span class="op">==</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">is.numeric</span>(item)) {
    item &lt;-<span class="st"> </span>haven<span class="op">::</span><span class="kw">zap_labels</span>(item)
  }
}
item_nomiss &lt;-<span class="st"> </span>item[<span class="op">!</span><span class="kw">is.na</span>(item)]

<span class="co"># unnest mc_multiple and so on</span>
<span class="cf">if</span> (
  <span class="kw">is.character</span>(item_nomiss) <span class="op">&amp;&amp;</span>
<span class="st">  </span>stringr<span class="op">::</span><span class="kw">str_detect</span>(item_nomiss, stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;, &quot;</span>)) <span class="op">&amp;&amp;</span>
<span class="st">  </span>(<span class="kw">exists</span>(<span class="st">&quot;type&quot;</span>, item_info) <span class="op">&amp;&amp;</span><span class="st"> </span>
<span class="st">    </span>stringr<span class="op">::</span><span class="kw">str_detect</span>(item_info<span class="op">$</span>type, <span class="dt">pattern =</span> stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;multiple&quot;</span>)))
  ) {
  item_nomiss &lt;-<span class="st"> </span><span class="kw">unlist</span>(stringr<span class="op">::</span><span class="kw">str_split</span>(item_nomiss, <span class="dt">pattern =</span> stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;, &quot;</span>)))
}
<span class="kw">attributes</span>(item_nomiss) &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)

old_height &lt;-<span class="st"> </span>knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;fig.height&quot;</span>)
non_missing_choices &lt;-<span class="st"> </span>item_attributes[[<span class="st">&quot;labels&quot;</span>]]
many_labels &lt;-<span class="st"> </span><span class="kw">length</span>(non_missing_choices) <span class="op">&gt;</span><span class="st"> </span><span class="dv">7</span>
go_vertical &lt;-<span class="st"> </span><span class="op">!</span><span class="kw">is.numeric</span>(item_nomiss) <span class="op">||</span><span class="st"> </span>many_labels
<span class="cf">if</span> ( go_vertical ) {
  <span class="co"># numeric items are plotted horizontally (because that&#39;s what usually expected)</span>
  <span class="co"># categorical items are plotted vertically because we can use the screen real estate better this way</span>

    <span class="cf">if</span> (<span class="kw">is.null</span>(choices) <span class="op">||</span><span class="st"> </span>
<span class="st">        </span>dplyr<span class="op">::</span><span class="kw">n_distinct</span>(item_nomiss) <span class="op">&gt;</span><span class="st"> </span><span class="kw">length</span>(non_missing_choices)) {
        non_missing_choices &lt;-<span class="st"> </span><span class="kw">unique</span>(item_nomiss)
        <span class="kw">names</span>(non_missing_choices) &lt;-<span class="st"> </span>non_missing_choices
    }
  choice_multiplier &lt;-<span class="st"> </span>old_height<span class="op">/</span><span class="fl">6.5</span>
    new_height &lt;-<span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>choice_multiplier <span class="op">*</span><span class="st"> </span><span class="kw">length</span>(non_missing_choices)
    new_height &lt;-<span class="st"> </span><span class="kw">ifelse</span>(new_height <span class="op">&gt;</span><span class="st"> </span><span class="dv">20</span>, <span class="dv">20</span>, new_height)
    new_height &lt;-<span class="st"> </span><span class="kw">ifelse</span>(new_height <span class="op">&lt;</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">1</span>, new_height)
    knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">fig.height =</span> new_height)
}

wrap_at &lt;-<span class="st"> </span>knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;fig.width&quot;</span>) <span class="op">*</span><span class="st"> </span><span class="dv">10</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># todo: if there are free-text choices mingled in with the pre-defined ones, don&#39;t show</span>
<span class="co"># todo: show rare items if they are pre-defined</span>
<span class="co"># todo: bin rare responses into &quot;other category&quot;</span>
<span class="cf">if</span> (<span class="op">!</span><span class="kw">length</span>(item_nomiss)) {
  <span class="kw">cat</span>(<span class="st">&quot;No non-missing values to show.&quot;</span>)
} <span class="cf">else</span> <span class="cf">if</span> (<span class="kw">is.numeric</span>(item_nomiss) <span class="op">||</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">n_distinct</span>(item_nomiss) <span class="op">&lt;</span><span class="st"> </span><span class="dv">20</span>) {
  <span class="kw">plot_labelled</span>(item_nomiss, item_name, wrap_at, go_vertical)
} <span class="cf">else</span> {
    <span class="kw">cat</span>(dplyr<span class="op">::</span><span class="kw">n_distinct</span>(item_nomiss), <span class="st">&quot; unique, categorical values, so not shown.&quot;</span>)
}</code></pre></div>
<p><img src="Bookdown-goodloser_files/figure-html/r13pad5_vinnermargin_distribution-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">fig.height =</span> old_height)</code></pre></div>
<p>0 missings.</p>
</div>
<div id="r13pad5_vinnermargin_summary" class="section level4">
<h4><span class="header-section-number">3.1.9.2</span> Summary statistics</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">attributes</span>(item) &lt;-<span class="st"> </span>item_attributes
df =<span class="st"> </span><span class="kw">data.frame</span>(item, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)
<span class="kw">names</span>(df) =<span class="st"> </span>html_item_name
<span class="kw">escaped_table</span>(<span class="kw">codebook_table</span>(df))</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
name
</th>
<th style="text-align:left;">
data_type
</th>
<th style="text-align:left;">
missing
</th>
<th style="text-align:left;">
complete
</th>
<th style="text-align:left;">
n
</th>
<th style="text-align:left;">
mean
</th>
<th style="text-align:left;">
sd
</th>
<th style="text-align:left;">
p0
</th>
<th style="text-align:left;">
p25
</th>
<th style="text-align:left;">
p50
</th>
<th style="text-align:left;">
p75
</th>
<th style="text-align:left;">
p100
</th>
<th style="text-align:left;">
hist
</th>
<th style="text-align:left;">
format.spss
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
r13pad5_vinnermargin
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
2843
</td>
<td style="text-align:left;">
2843
</td>
<td style="text-align:left;">
1.99
</td>
<td style="text-align:left;">
0.82
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
▇▁▁▇▁▁▁▇
</td>
<td style="text-align:left;">
F8.2
</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (show_missings) {
  <span class="kw">plot_labelled</span>(missings, item_name, wrap_at)
}</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(item_info)) {
  <span class="co"># don&#39;t show choices again, if they&#39;re basically same thing as value labels</span>
  <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.null</span>(item_info<span class="op">$</span>choices) <span class="op">&amp;&amp;</span><span class="st"> </span>
<span class="st">    </span><span class="kw">all</span>(<span class="kw">names</span>(<span class="kw">na.omit</span>(choices)) <span class="op">==</span><span class="st"> </span>item_info<span class="op">$</span>choices) <span class="op">&amp;&amp;</span>
<span class="st">    </span><span class="kw">all</span>(<span class="kw">na.omit</span>(choices) <span class="op">==</span><span class="st"> </span><span class="kw">names</span>(item_info<span class="op">$</span>choices))) {
    item_info<span class="op">$</span>choices &lt;-<span class="st"> </span><span class="ot">NULL</span>
  }
  item_info<span class="op">$</span>label_parsed &lt;-<span class="st"> </span>
<span class="st">    </span>item_info<span class="op">$</span>choice_list &lt;-<span class="st"> </span>item_info<span class="op">$</span>study_id &lt;-<span class="st"> </span>item_info<span class="op">$</span>id &lt;-<span class="st"> </span><span class="ot">NULL</span>
  pander<span class="op">::</span><span class="kw">pander</span>(item_info)
}</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">length</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">length</span>(choices) <span class="op">&lt;</span><span class="st"> </span><span class="dv">30</span>) {
    pander<span class="op">::</span><span class="kw">pander</span>(<span class="kw">as.list</span>(choices))
}</code></pre></div>
</div>
</div>
<div id="r13pad6_ran" class="section level3 tabset">
<h3><span class="header-section-number">3.1.10</span> r13pad6_ran</h3>
<div id="r13pad6_ran_distribution" class="section level4">
<h4><span class="header-section-number">3.1.10.1</span> Distribution</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">show_missings &lt;-<span class="st"> </span><span class="ot">FALSE</span>
<span class="cf">if</span> (<span class="kw">has_label</span>(item)) {
  missings &lt;-<span class="st"> </span>item[<span class="kw">is.na</span>(haven<span class="op">::</span><span class="kw">zap_missing</span>(item))]
  <span class="kw">attributes</span>(missings) &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)
  <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(<span class="kw">attributes</span>(item)<span class="op">$</span>labels)) {
    <span class="kw">attributes</span>(missings)<span class="op">$</span>labels &lt;-<span class="st"> </span><span class="kw">attributes</span>(missings)<span class="op">$</span>labels[<span class="kw">is.na</span>(<span class="kw">attributes</span>(missings)<span class="op">$</span>labels)]
    <span class="kw">attributes</span>(item)<span class="op">$</span>labels &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)<span class="op">$</span>labels[<span class="op">!</span><span class="kw">is.na</span>(<span class="kw">attributes</span>(item)<span class="op">$</span>labels)]
  }
  <span class="cf">if</span> (<span class="kw">is.numeric</span>(item)) {
    show_missings &lt;-<span class="st"> </span><span class="kw">length</span>(<span class="kw">unique</span>(haven<span class="op">::</span><span class="kw">na_tag</span>(missings))) <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>
    item &lt;-<span class="st"> </span>haven<span class="op">::</span><span class="kw">zap_missing</span>(item)
  }
  <span class="cf">if</span> (<span class="kw">length</span>(item_attributes<span class="op">$</span>labels) <span class="op">==</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">is.numeric</span>(item)) {
    item &lt;-<span class="st"> </span>haven<span class="op">::</span><span class="kw">zap_labels</span>(item)
  }
}
item_nomiss &lt;-<span class="st"> </span>item[<span class="op">!</span><span class="kw">is.na</span>(item)]

<span class="co"># unnest mc_multiple and so on</span>
<span class="cf">if</span> (
  <span class="kw">is.character</span>(item_nomiss) <span class="op">&amp;&amp;</span>
<span class="st">  </span>stringr<span class="op">::</span><span class="kw">str_detect</span>(item_nomiss, stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;, &quot;</span>)) <span class="op">&amp;&amp;</span>
<span class="st">  </span>(<span class="kw">exists</span>(<span class="st">&quot;type&quot;</span>, item_info) <span class="op">&amp;&amp;</span><span class="st"> </span>
<span class="st">    </span>stringr<span class="op">::</span><span class="kw">str_detect</span>(item_info<span class="op">$</span>type, <span class="dt">pattern =</span> stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;multiple&quot;</span>)))
  ) {
  item_nomiss &lt;-<span class="st"> </span><span class="kw">unlist</span>(stringr<span class="op">::</span><span class="kw">str_split</span>(item_nomiss, <span class="dt">pattern =</span> stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;, &quot;</span>)))
}
<span class="kw">attributes</span>(item_nomiss) &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)

old_height &lt;-<span class="st"> </span>knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;fig.height&quot;</span>)
non_missing_choices &lt;-<span class="st"> </span>item_attributes[[<span class="st">&quot;labels&quot;</span>]]
many_labels &lt;-<span class="st"> </span><span class="kw">length</span>(non_missing_choices) <span class="op">&gt;</span><span class="st"> </span><span class="dv">7</span>
go_vertical &lt;-<span class="st"> </span><span class="op">!</span><span class="kw">is.numeric</span>(item_nomiss) <span class="op">||</span><span class="st"> </span>many_labels
<span class="cf">if</span> ( go_vertical ) {
  <span class="co"># numeric items are plotted horizontally (because that&#39;s what usually expected)</span>
  <span class="co"># categorical items are plotted vertically because we can use the screen real estate better this way</span>

    <span class="cf">if</span> (<span class="kw">is.null</span>(choices) <span class="op">||</span><span class="st"> </span>
<span class="st">        </span>dplyr<span class="op">::</span><span class="kw">n_distinct</span>(item_nomiss) <span class="op">&gt;</span><span class="st"> </span><span class="kw">length</span>(non_missing_choices)) {
        non_missing_choices &lt;-<span class="st"> </span><span class="kw">unique</span>(item_nomiss)
        <span class="kw">names</span>(non_missing_choices) &lt;-<span class="st"> </span>non_missing_choices
    }
  choice_multiplier &lt;-<span class="st"> </span>old_height<span class="op">/</span><span class="fl">6.5</span>
    new_height &lt;-<span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>choice_multiplier <span class="op">*</span><span class="st"> </span><span class="kw">length</span>(non_missing_choices)
    new_height &lt;-<span class="st"> </span><span class="kw">ifelse</span>(new_height <span class="op">&gt;</span><span class="st"> </span><span class="dv">20</span>, <span class="dv">20</span>, new_height)
    new_height &lt;-<span class="st"> </span><span class="kw">ifelse</span>(new_height <span class="op">&lt;</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">1</span>, new_height)
    knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">fig.height =</span> new_height)
}

wrap_at &lt;-<span class="st"> </span>knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;fig.width&quot;</span>) <span class="op">*</span><span class="st"> </span><span class="dv">10</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># todo: if there are free-text choices mingled in with the pre-defined ones, don&#39;t show</span>
<span class="co"># todo: show rare items if they are pre-defined</span>
<span class="co"># todo: bin rare responses into &quot;other category&quot;</span>
<span class="cf">if</span> (<span class="op">!</span><span class="kw">length</span>(item_nomiss)) {
  <span class="kw">cat</span>(<span class="st">&quot;No non-missing values to show.&quot;</span>)
} <span class="cf">else</span> <span class="cf">if</span> (<span class="kw">is.numeric</span>(item_nomiss) <span class="op">||</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">n_distinct</span>(item_nomiss) <span class="op">&lt;</span><span class="st"> </span><span class="dv">20</span>) {
  <span class="kw">plot_labelled</span>(item_nomiss, item_name, wrap_at, go_vertical)
} <span class="cf">else</span> {
    <span class="kw">cat</span>(dplyr<span class="op">::</span><span class="kw">n_distinct</span>(item_nomiss), <span class="st">&quot; unique, categorical values, so not shown.&quot;</span>)
}</code></pre></div>
<p><img src="Bookdown-goodloser_files/figure-html/r13pad6_ran_distribution-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">fig.height =</span> old_height)</code></pre></div>
<p>0 missings.</p>
</div>
<div id="r13pad6_ran_summary" class="section level4">
<h4><span class="header-section-number">3.1.10.2</span> Summary statistics</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">attributes</span>(item) &lt;-<span class="st"> </span>item_attributes
df =<span class="st"> </span><span class="kw">data.frame</span>(item, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)
<span class="kw">names</span>(df) =<span class="st"> </span>html_item_name
<span class="kw">escaped_table</span>(<span class="kw">codebook_table</span>(df))</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
name
</th>
<th style="text-align:left;">
data_type
</th>
<th style="text-align:left;">
missing
</th>
<th style="text-align:left;">
complete
</th>
<th style="text-align:left;">
n
</th>
<th style="text-align:left;">
mean
</th>
<th style="text-align:left;">
sd
</th>
<th style="text-align:left;">
p0
</th>
<th style="text-align:left;">
p25
</th>
<th style="text-align:left;">
p50
</th>
<th style="text-align:left;">
p75
</th>
<th style="text-align:left;">
p100
</th>
<th style="text-align:left;">
hist
</th>
<th style="text-align:left;">
format.spss
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
r13pad6_ran
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
2843
</td>
<td style="text-align:left;">
2843
</td>
<td style="text-align:left;">
1.48
</td>
<td style="text-align:left;">
0.5
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
▇▁▁▁▁▁▁▇
</td>
<td style="text-align:left;">
F8.2
</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (show_missings) {
  <span class="kw">plot_labelled</span>(missings, item_name, wrap_at)
}</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(item_info)) {
  <span class="co"># don&#39;t show choices again, if they&#39;re basically same thing as value labels</span>
  <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.null</span>(item_info<span class="op">$</span>choices) <span class="op">&amp;&amp;</span><span class="st"> </span>
<span class="st">    </span><span class="kw">all</span>(<span class="kw">names</span>(<span class="kw">na.omit</span>(choices)) <span class="op">==</span><span class="st"> </span>item_info<span class="op">$</span>choices) <span class="op">&amp;&amp;</span>
<span class="st">    </span><span class="kw">all</span>(<span class="kw">na.omit</span>(choices) <span class="op">==</span><span class="st"> </span><span class="kw">names</span>(item_info<span class="op">$</span>choices))) {
    item_info<span class="op">$</span>choices &lt;-<span class="st"> </span><span class="ot">NULL</span>
  }
  item_info<span class="op">$</span>label_parsed &lt;-<span class="st"> </span>
<span class="st">    </span>item_info<span class="op">$</span>choice_list &lt;-<span class="st"> </span>item_info<span class="op">$</span>study_id &lt;-<span class="st"> </span>item_info<span class="op">$</span>id &lt;-<span class="st"> </span><span class="ot">NULL</span>
  pander<span class="op">::</span><span class="kw">pander</span>(item_info)
}</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">length</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">length</span>(choices) <span class="op">&lt;</span><span class="st"> </span><span class="dv">30</span>) {
    pander<span class="op">::</span><span class="kw">pander</span>(<span class="kw">as.list</span>(choices))
}</code></pre></div>
</div>
</div>
<div id="r13pad6a" class="section level3 tabset">
<h3><span class="header-section-number">3.1.11</span> r13pad6a</h3>
<div id="r13pad6a_distribution" class="section level4">
<h4><span class="header-section-number">3.1.11.1</span> Distribution</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">show_missings &lt;-<span class="st"> </span><span class="ot">FALSE</span>
<span class="cf">if</span> (<span class="kw">has_label</span>(item)) {
  missings &lt;-<span class="st"> </span>item[<span class="kw">is.na</span>(haven<span class="op">::</span><span class="kw">zap_missing</span>(item))]
  <span class="kw">attributes</span>(missings) &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)
  <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(<span class="kw">attributes</span>(item)<span class="op">$</span>labels)) {
    <span class="kw">attributes</span>(missings)<span class="op">$</span>labels &lt;-<span class="st"> </span><span class="kw">attributes</span>(missings)<span class="op">$</span>labels[<span class="kw">is.na</span>(<span class="kw">attributes</span>(missings)<span class="op">$</span>labels)]
    <span class="kw">attributes</span>(item)<span class="op">$</span>labels &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)<span class="op">$</span>labels[<span class="op">!</span><span class="kw">is.na</span>(<span class="kw">attributes</span>(item)<span class="op">$</span>labels)]
  }
  <span class="cf">if</span> (<span class="kw">is.numeric</span>(item)) {
    show_missings &lt;-<span class="st"> </span><span class="kw">length</span>(<span class="kw">unique</span>(haven<span class="op">::</span><span class="kw">na_tag</span>(missings))) <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>
    item &lt;-<span class="st"> </span>haven<span class="op">::</span><span class="kw">zap_missing</span>(item)
  }
  <span class="cf">if</span> (<span class="kw">length</span>(item_attributes<span class="op">$</span>labels) <span class="op">==</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">is.numeric</span>(item)) {
    item &lt;-<span class="st"> </span>haven<span class="op">::</span><span class="kw">zap_labels</span>(item)
  }
}
item_nomiss &lt;-<span class="st"> </span>item[<span class="op">!</span><span class="kw">is.na</span>(item)]

<span class="co"># unnest mc_multiple and so on</span>
<span class="cf">if</span> (
  <span class="kw">is.character</span>(item_nomiss) <span class="op">&amp;&amp;</span>
<span class="st">  </span>stringr<span class="op">::</span><span class="kw">str_detect</span>(item_nomiss, stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;, &quot;</span>)) <span class="op">&amp;&amp;</span>
<span class="st">  </span>(<span class="kw">exists</span>(<span class="st">&quot;type&quot;</span>, item_info) <span class="op">&amp;&amp;</span><span class="st"> </span>
<span class="st">    </span>stringr<span class="op">::</span><span class="kw">str_detect</span>(item_info<span class="op">$</span>type, <span class="dt">pattern =</span> stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;multiple&quot;</span>)))
  ) {
  item_nomiss &lt;-<span class="st"> </span><span class="kw">unlist</span>(stringr<span class="op">::</span><span class="kw">str_split</span>(item_nomiss, <span class="dt">pattern =</span> stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;, &quot;</span>)))
}
<span class="kw">attributes</span>(item_nomiss) &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)

old_height &lt;-<span class="st"> </span>knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;fig.height&quot;</span>)
non_missing_choices &lt;-<span class="st"> </span>item_attributes[[<span class="st">&quot;labels&quot;</span>]]
many_labels &lt;-<span class="st"> </span><span class="kw">length</span>(non_missing_choices) <span class="op">&gt;</span><span class="st"> </span><span class="dv">7</span>
go_vertical &lt;-<span class="st"> </span><span class="op">!</span><span class="kw">is.numeric</span>(item_nomiss) <span class="op">||</span><span class="st"> </span>many_labels
<span class="cf">if</span> ( go_vertical ) {
  <span class="co"># numeric items are plotted horizontally (because that&#39;s what usually expected)</span>
  <span class="co"># categorical items are plotted vertically because we can use the screen real estate better this way</span>

    <span class="cf">if</span> (<span class="kw">is.null</span>(choices) <span class="op">||</span><span class="st"> </span>
<span class="st">        </span>dplyr<span class="op">::</span><span class="kw">n_distinct</span>(item_nomiss) <span class="op">&gt;</span><span class="st"> </span><span class="kw">length</span>(non_missing_choices)) {
        non_missing_choices &lt;-<span class="st"> </span><span class="kw">unique</span>(item_nomiss)
        <span class="kw">names</span>(non_missing_choices) &lt;-<span class="st"> </span>non_missing_choices
    }
  choice_multiplier &lt;-<span class="st"> </span>old_height<span class="op">/</span><span class="fl">6.5</span>
    new_height &lt;-<span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>choice_multiplier <span class="op">*</span><span class="st"> </span><span class="kw">length</span>(non_missing_choices)
    new_height &lt;-<span class="st"> </span><span class="kw">ifelse</span>(new_height <span class="op">&gt;</span><span class="st"> </span><span class="dv">20</span>, <span class="dv">20</span>, new_height)
    new_height &lt;-<span class="st"> </span><span class="kw">ifelse</span>(new_height <span class="op">&lt;</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">1</span>, new_height)
    knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">fig.height =</span> new_height)
}

wrap_at &lt;-<span class="st"> </span>knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;fig.width&quot;</span>) <span class="op">*</span><span class="st"> </span><span class="dv">10</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># todo: if there are free-text choices mingled in with the pre-defined ones, don&#39;t show</span>
<span class="co"># todo: show rare items if they are pre-defined</span>
<span class="co"># todo: bin rare responses into &quot;other category&quot;</span>
<span class="cf">if</span> (<span class="op">!</span><span class="kw">length</span>(item_nomiss)) {
  <span class="kw">cat</span>(<span class="st">&quot;No non-missing values to show.&quot;</span>)
} <span class="cf">else</span> <span class="cf">if</span> (<span class="kw">is.numeric</span>(item_nomiss) <span class="op">||</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">n_distinct</span>(item_nomiss) <span class="op">&lt;</span><span class="st"> </span><span class="dv">20</span>) {
  <span class="kw">plot_labelled</span>(item_nomiss, item_name, wrap_at, go_vertical)
} <span class="cf">else</span> {
    <span class="kw">cat</span>(dplyr<span class="op">::</span><span class="kw">n_distinct</span>(item_nomiss), <span class="st">&quot; unique, categorical values, so not shown.&quot;</span>)
}</code></pre></div>
<p><img src="Bookdown-goodloser_files/figure-html/r13pad6a_distribution-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">fig.height =</span> old_height)</code></pre></div>
<p>1360 missings.</p>
</div>
<div id="r13pad6a_summary" class="section level4">
<h4><span class="header-section-number">3.1.11.2</span> Summary statistics</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">attributes</span>(item) &lt;-<span class="st"> </span>item_attributes
df =<span class="st"> </span><span class="kw">data.frame</span>(item, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)
<span class="kw">names</span>(df) =<span class="st"> </span>html_item_name
<span class="kw">escaped_table</span>(<span class="kw">codebook_table</span>(df))</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
name
</th>
<th style="text-align:left;">
data_type
</th>
<th style="text-align:left;">
missing
</th>
<th style="text-align:left;">
complete
</th>
<th style="text-align:left;">
n
</th>
<th style="text-align:left;">
mean
</th>
<th style="text-align:left;">
sd
</th>
<th style="text-align:left;">
p0
</th>
<th style="text-align:left;">
p25
</th>
<th style="text-align:left;">
p50
</th>
<th style="text-align:left;">
p75
</th>
<th style="text-align:left;">
p100
</th>
<th style="text-align:left;">
hist
</th>
<th style="text-align:left;">
format.spss
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
r13pad6a
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:left;">
1360
</td>
<td style="text-align:left;">
1483
</td>
<td style="text-align:left;">
2843
</td>
<td style="text-align:left;">
1.71
</td>
<td style="text-align:left;">
14.02
</td>
<td style="text-align:left;">
-91
</td>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
5
</td>
<td style="text-align:left;">
▁▁▁▁▁▁▁▇
</td>
<td style="text-align:left;">
F8.2
</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (show_missings) {
  <span class="kw">plot_labelled</span>(missings, item_name, wrap_at)
}</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(item_info)) {
  <span class="co"># don&#39;t show choices again, if they&#39;re basically same thing as value labels</span>
  <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.null</span>(item_info<span class="op">$</span>choices) <span class="op">&amp;&amp;</span><span class="st"> </span>
<span class="st">    </span><span class="kw">all</span>(<span class="kw">names</span>(<span class="kw">na.omit</span>(choices)) <span class="op">==</span><span class="st"> </span>item_info<span class="op">$</span>choices) <span class="op">&amp;&amp;</span>
<span class="st">    </span><span class="kw">all</span>(<span class="kw">na.omit</span>(choices) <span class="op">==</span><span class="st"> </span><span class="kw">names</span>(item_info<span class="op">$</span>choices))) {
    item_info<span class="op">$</span>choices &lt;-<span class="st"> </span><span class="ot">NULL</span>
  }
  item_info<span class="op">$</span>label_parsed &lt;-<span class="st"> </span>
<span class="st">    </span>item_info<span class="op">$</span>choice_list &lt;-<span class="st"> </span>item_info<span class="op">$</span>study_id &lt;-<span class="st"> </span>item_info<span class="op">$</span>id &lt;-<span class="st"> </span><span class="ot">NULL</span>
  pander<span class="op">::</span><span class="kw">pander</span>(item_info)
}</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">length</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">length</span>(choices) <span class="op">&lt;</span><span class="st"> </span><span class="dv">30</span>) {
    pander<span class="op">::</span><span class="kw">pander</span>(<span class="kw">as.list</span>(choices))
}</code></pre></div>
</div>
</div>
<div id="r13pad6b" class="section level3 tabset">
<h3><span class="header-section-number">3.1.12</span> r13pad6b</h3>
<div id="r13pad6b_distribution" class="section level4">
<h4><span class="header-section-number">3.1.12.1</span> Distribution</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">show_missings &lt;-<span class="st"> </span><span class="ot">FALSE</span>
<span class="cf">if</span> (<span class="kw">has_label</span>(item)) {
  missings &lt;-<span class="st"> </span>item[<span class="kw">is.na</span>(haven<span class="op">::</span><span class="kw">zap_missing</span>(item))]
  <span class="kw">attributes</span>(missings) &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)
  <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(<span class="kw">attributes</span>(item)<span class="op">$</span>labels)) {
    <span class="kw">attributes</span>(missings)<span class="op">$</span>labels &lt;-<span class="st"> </span><span class="kw">attributes</span>(missings)<span class="op">$</span>labels[<span class="kw">is.na</span>(<span class="kw">attributes</span>(missings)<span class="op">$</span>labels)]
    <span class="kw">attributes</span>(item)<span class="op">$</span>labels &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)<span class="op">$</span>labels[<span class="op">!</span><span class="kw">is.na</span>(<span class="kw">attributes</span>(item)<span class="op">$</span>labels)]
  }
  <span class="cf">if</span> (<span class="kw">is.numeric</span>(item)) {
    show_missings &lt;-<span class="st"> </span><span class="kw">length</span>(<span class="kw">unique</span>(haven<span class="op">::</span><span class="kw">na_tag</span>(missings))) <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>
    item &lt;-<span class="st"> </span>haven<span class="op">::</span><span class="kw">zap_missing</span>(item)
  }
  <span class="cf">if</span> (<span class="kw">length</span>(item_attributes<span class="op">$</span>labels) <span class="op">==</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">is.numeric</span>(item)) {
    item &lt;-<span class="st"> </span>haven<span class="op">::</span><span class="kw">zap_labels</span>(item)
  }
}
item_nomiss &lt;-<span class="st"> </span>item[<span class="op">!</span><span class="kw">is.na</span>(item)]

<span class="co"># unnest mc_multiple and so on</span>
<span class="cf">if</span> (
  <span class="kw">is.character</span>(item_nomiss) <span class="op">&amp;&amp;</span>
<span class="st">  </span>stringr<span class="op">::</span><span class="kw">str_detect</span>(item_nomiss, stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;, &quot;</span>)) <span class="op">&amp;&amp;</span>
<span class="st">  </span>(<span class="kw">exists</span>(<span class="st">&quot;type&quot;</span>, item_info) <span class="op">&amp;&amp;</span><span class="st"> </span>
<span class="st">    </span>stringr<span class="op">::</span><span class="kw">str_detect</span>(item_info<span class="op">$</span>type, <span class="dt">pattern =</span> stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;multiple&quot;</span>)))
  ) {
  item_nomiss &lt;-<span class="st"> </span><span class="kw">unlist</span>(stringr<span class="op">::</span><span class="kw">str_split</span>(item_nomiss, <span class="dt">pattern =</span> stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;, &quot;</span>)))
}
<span class="kw">attributes</span>(item_nomiss) &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)

old_height &lt;-<span class="st"> </span>knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;fig.height&quot;</span>)
non_missing_choices &lt;-<span class="st"> </span>item_attributes[[<span class="st">&quot;labels&quot;</span>]]
many_labels &lt;-<span class="st"> </span><span class="kw">length</span>(non_missing_choices) <span class="op">&gt;</span><span class="st"> </span><span class="dv">7</span>
go_vertical &lt;-<span class="st"> </span><span class="op">!</span><span class="kw">is.numeric</span>(item_nomiss) <span class="op">||</span><span class="st"> </span>many_labels
<span class="cf">if</span> ( go_vertical ) {
  <span class="co"># numeric items are plotted horizontally (because that&#39;s what usually expected)</span>
  <span class="co"># categorical items are plotted vertically because we can use the screen real estate better this way</span>

    <span class="cf">if</span> (<span class="kw">is.null</span>(choices) <span class="op">||</span><span class="st"> </span>
<span class="st">        </span>dplyr<span class="op">::</span><span class="kw">n_distinct</span>(item_nomiss) <span class="op">&gt;</span><span class="st"> </span><span class="kw">length</span>(non_missing_choices)) {
        non_missing_choices &lt;-<span class="st"> </span><span class="kw">unique</span>(item_nomiss)
        <span class="kw">names</span>(non_missing_choices) &lt;-<span class="st"> </span>non_missing_choices
    }
  choice_multiplier &lt;-<span class="st"> </span>old_height<span class="op">/</span><span class="fl">6.5</span>
    new_height &lt;-<span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>choice_multiplier <span class="op">*</span><span class="st"> </span><span class="kw">length</span>(non_missing_choices)
    new_height &lt;-<span class="st"> </span><span class="kw">ifelse</span>(new_height <span class="op">&gt;</span><span class="st"> </span><span class="dv">20</span>, <span class="dv">20</span>, new_height)
    new_height &lt;-<span class="st"> </span><span class="kw">ifelse</span>(new_height <span class="op">&lt;</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">1</span>, new_height)
    knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">fig.height =</span> new_height)
}

wrap_at &lt;-<span class="st"> </span>knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;fig.width&quot;</span>) <span class="op">*</span><span class="st"> </span><span class="dv">10</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># todo: if there are free-text choices mingled in with the pre-defined ones, don&#39;t show</span>
<span class="co"># todo: show rare items if they are pre-defined</span>
<span class="co"># todo: bin rare responses into &quot;other category&quot;</span>
<span class="cf">if</span> (<span class="op">!</span><span class="kw">length</span>(item_nomiss)) {
  <span class="kw">cat</span>(<span class="st">&quot;No non-missing values to show.&quot;</span>)
} <span class="cf">else</span> <span class="cf">if</span> (<span class="kw">is.numeric</span>(item_nomiss) <span class="op">||</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">n_distinct</span>(item_nomiss) <span class="op">&lt;</span><span class="st"> </span><span class="dv">20</span>) {
  <span class="kw">plot_labelled</span>(item_nomiss, item_name, wrap_at, go_vertical)
} <span class="cf">else</span> {
    <span class="kw">cat</span>(dplyr<span class="op">::</span><span class="kw">n_distinct</span>(item_nomiss), <span class="st">&quot; unique, categorical values, so not shown.&quot;</span>)
}</code></pre></div>
<p><img src="Bookdown-goodloser_files/figure-html/r13pad6b_distribution-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">fig.height =</span> old_height)</code></pre></div>
<p>1483 missings.</p>
</div>
<div id="r13pad6b_summary" class="section level4">
<h4><span class="header-section-number">3.1.12.2</span> Summary statistics</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">attributes</span>(item) &lt;-<span class="st"> </span>item_attributes
df =<span class="st"> </span><span class="kw">data.frame</span>(item, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)
<span class="kw">names</span>(df) =<span class="st"> </span>html_item_name
<span class="kw">escaped_table</span>(<span class="kw">codebook_table</span>(df))</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
name
</th>
<th style="text-align:left;">
data_type
</th>
<th style="text-align:left;">
missing
</th>
<th style="text-align:left;">
complete
</th>
<th style="text-align:left;">
n
</th>
<th style="text-align:left;">
mean
</th>
<th style="text-align:left;">
sd
</th>
<th style="text-align:left;">
p0
</th>
<th style="text-align:left;">
p25
</th>
<th style="text-align:left;">
p50
</th>
<th style="text-align:left;">
p75
</th>
<th style="text-align:left;">
p100
</th>
<th style="text-align:left;">
hist
</th>
<th style="text-align:left;">
format.spss
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
r13pad6b
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:left;">
1483
</td>
<td style="text-align:left;">
1360
</td>
<td style="text-align:left;">
2843
</td>
<td style="text-align:left;">
2.45
</td>
<td style="text-align:left;">
12.31
</td>
<td style="text-align:left;">
-91
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
5
</td>
<td style="text-align:left;">
5
</td>
<td style="text-align:left;">
▁▁▁▁▁▁▁▇
</td>
<td style="text-align:left;">
F8.2
</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (show_missings) {
  <span class="kw">plot_labelled</span>(missings, item_name, wrap_at)
}</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(item_info)) {
  <span class="co"># don&#39;t show choices again, if they&#39;re basically same thing as value labels</span>
  <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.null</span>(item_info<span class="op">$</span>choices) <span class="op">&amp;&amp;</span><span class="st"> </span>
<span class="st">    </span><span class="kw">all</span>(<span class="kw">names</span>(<span class="kw">na.omit</span>(choices)) <span class="op">==</span><span class="st"> </span>item_info<span class="op">$</span>choices) <span class="op">&amp;&amp;</span>
<span class="st">    </span><span class="kw">all</span>(<span class="kw">na.omit</span>(choices) <span class="op">==</span><span class="st"> </span><span class="kw">names</span>(item_info<span class="op">$</span>choices))) {
    item_info<span class="op">$</span>choices &lt;-<span class="st"> </span><span class="ot">NULL</span>
  }
  item_info<span class="op">$</span>label_parsed &lt;-<span class="st"> </span>
<span class="st">    </span>item_info<span class="op">$</span>choice_list &lt;-<span class="st"> </span>item_info<span class="op">$</span>study_id &lt;-<span class="st"> </span>item_info<span class="op">$</span>id &lt;-<span class="st"> </span><span class="ot">NULL</span>
  pander<span class="op">::</span><span class="kw">pander</span>(item_info)
}</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">length</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">length</span>(choices) <span class="op">&lt;</span><span class="st"> </span><span class="dv">30</span>) {
    pander<span class="op">::</span><span class="kw">pander</span>(<span class="kw">as.list</span>(choices))
}</code></pre></div>
</div>
</div>
<div id="r13pad7a" class="section level3 tabset">
<h3><span class="header-section-number">3.1.13</span> r13pad7a</h3>
<div id="r13pad7a_distribution" class="section level4">
<h4><span class="header-section-number">3.1.13.1</span> Distribution</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">show_missings &lt;-<span class="st"> </span><span class="ot">FALSE</span>
<span class="cf">if</span> (<span class="kw">has_label</span>(item)) {
  missings &lt;-<span class="st"> </span>item[<span class="kw">is.na</span>(haven<span class="op">::</span><span class="kw">zap_missing</span>(item))]
  <span class="kw">attributes</span>(missings) &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)
  <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(<span class="kw">attributes</span>(item)<span class="op">$</span>labels)) {
    <span class="kw">attributes</span>(missings)<span class="op">$</span>labels &lt;-<span class="st"> </span><span class="kw">attributes</span>(missings)<span class="op">$</span>labels[<span class="kw">is.na</span>(<span class="kw">attributes</span>(missings)<span class="op">$</span>labels)]
    <span class="kw">attributes</span>(item)<span class="op">$</span>labels &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)<span class="op">$</span>labels[<span class="op">!</span><span class="kw">is.na</span>(<span class="kw">attributes</span>(item)<span class="op">$</span>labels)]
  }
  <span class="cf">if</span> (<span class="kw">is.numeric</span>(item)) {
    show_missings &lt;-<span class="st"> </span><span class="kw">length</span>(<span class="kw">unique</span>(haven<span class="op">::</span><span class="kw">na_tag</span>(missings))) <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>
    item &lt;-<span class="st"> </span>haven<span class="op">::</span><span class="kw">zap_missing</span>(item)
  }
  <span class="cf">if</span> (<span class="kw">length</span>(item_attributes<span class="op">$</span>labels) <span class="op">==</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">is.numeric</span>(item)) {
    item &lt;-<span class="st"> </span>haven<span class="op">::</span><span class="kw">zap_labels</span>(item)
  }
}
item_nomiss &lt;-<span class="st"> </span>item[<span class="op">!</span><span class="kw">is.na</span>(item)]

<span class="co"># unnest mc_multiple and so on</span>
<span class="cf">if</span> (
  <span class="kw">is.character</span>(item_nomiss) <span class="op">&amp;&amp;</span>
<span class="st">  </span>stringr<span class="op">::</span><span class="kw">str_detect</span>(item_nomiss, stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;, &quot;</span>)) <span class="op">&amp;&amp;</span>
<span class="st">  </span>(<span class="kw">exists</span>(<span class="st">&quot;type&quot;</span>, item_info) <span class="op">&amp;&amp;</span><span class="st"> </span>
<span class="st">    </span>stringr<span class="op">::</span><span class="kw">str_detect</span>(item_info<span class="op">$</span>type, <span class="dt">pattern =</span> stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;multiple&quot;</span>)))
  ) {
  item_nomiss &lt;-<span class="st"> </span><span class="kw">unlist</span>(stringr<span class="op">::</span><span class="kw">str_split</span>(item_nomiss, <span class="dt">pattern =</span> stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;, &quot;</span>)))
}
<span class="kw">attributes</span>(item_nomiss) &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)

old_height &lt;-<span class="st"> </span>knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;fig.height&quot;</span>)
non_missing_choices &lt;-<span class="st"> </span>item_attributes[[<span class="st">&quot;labels&quot;</span>]]
many_labels &lt;-<span class="st"> </span><span class="kw">length</span>(non_missing_choices) <span class="op">&gt;</span><span class="st"> </span><span class="dv">7</span>
go_vertical &lt;-<span class="st"> </span><span class="op">!</span><span class="kw">is.numeric</span>(item_nomiss) <span class="op">||</span><span class="st"> </span>many_labels
<span class="cf">if</span> ( go_vertical ) {
  <span class="co"># numeric items are plotted horizontally (because that&#39;s what usually expected)</span>
  <span class="co"># categorical items are plotted vertically because we can use the screen real estate better this way</span>

    <span class="cf">if</span> (<span class="kw">is.null</span>(choices) <span class="op">||</span><span class="st"> </span>
<span class="st">        </span>dplyr<span class="op">::</span><span class="kw">n_distinct</span>(item_nomiss) <span class="op">&gt;</span><span class="st"> </span><span class="kw">length</span>(non_missing_choices)) {
        non_missing_choices &lt;-<span class="st"> </span><span class="kw">unique</span>(item_nomiss)
        <span class="kw">names</span>(non_missing_choices) &lt;-<span class="st"> </span>non_missing_choices
    }
  choice_multiplier &lt;-<span class="st"> </span>old_height<span class="op">/</span><span class="fl">6.5</span>
    new_height &lt;-<span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>choice_multiplier <span class="op">*</span><span class="st"> </span><span class="kw">length</span>(non_missing_choices)
    new_height &lt;-<span class="st"> </span><span class="kw">ifelse</span>(new_height <span class="op">&gt;</span><span class="st"> </span><span class="dv">20</span>, <span class="dv">20</span>, new_height)
    new_height &lt;-<span class="st"> </span><span class="kw">ifelse</span>(new_height <span class="op">&lt;</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">1</span>, new_height)
    knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">fig.height =</span> new_height)
}

wrap_at &lt;-<span class="st"> </span>knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;fig.width&quot;</span>) <span class="op">*</span><span class="st"> </span><span class="dv">10</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># todo: if there are free-text choices mingled in with the pre-defined ones, don&#39;t show</span>
<span class="co"># todo: show rare items if they are pre-defined</span>
<span class="co"># todo: bin rare responses into &quot;other category&quot;</span>
<span class="cf">if</span> (<span class="op">!</span><span class="kw">length</span>(item_nomiss)) {
  <span class="kw">cat</span>(<span class="st">&quot;No non-missing values to show.&quot;</span>)
} <span class="cf">else</span> <span class="cf">if</span> (<span class="kw">is.numeric</span>(item_nomiss) <span class="op">||</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">n_distinct</span>(item_nomiss) <span class="op">&lt;</span><span class="st"> </span><span class="dv">20</span>) {
  <span class="kw">plot_labelled</span>(item_nomiss, item_name, wrap_at, go_vertical)
} <span class="cf">else</span> {
    <span class="kw">cat</span>(dplyr<span class="op">::</span><span class="kw">n_distinct</span>(item_nomiss), <span class="st">&quot; unique, categorical values, so not shown.&quot;</span>)
}</code></pre></div>
<p><img src="Bookdown-goodloser_files/figure-html/r13pad7a_distribution-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">fig.height =</span> old_height)</code></pre></div>
<p>1360 missings.</p>
</div>
<div id="r13pad7a_summary" class="section level4">
<h4><span class="header-section-number">3.1.13.2</span> Summary statistics</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">attributes</span>(item) &lt;-<span class="st"> </span>item_attributes
df =<span class="st"> </span><span class="kw">data.frame</span>(item, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)
<span class="kw">names</span>(df) =<span class="st"> </span>html_item_name
<span class="kw">escaped_table</span>(<span class="kw">codebook_table</span>(df))</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
name
</th>
<th style="text-align:left;">
data_type
</th>
<th style="text-align:left;">
missing
</th>
<th style="text-align:left;">
complete
</th>
<th style="text-align:left;">
n
</th>
<th style="text-align:left;">
mean
</th>
<th style="text-align:left;">
sd
</th>
<th style="text-align:left;">
p0
</th>
<th style="text-align:left;">
p25
</th>
<th style="text-align:left;">
p50
</th>
<th style="text-align:left;">
p75
</th>
<th style="text-align:left;">
p100
</th>
<th style="text-align:left;">
hist
</th>
<th style="text-align:left;">
format.spss
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
r13pad7a
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:left;">
1360
</td>
<td style="text-align:left;">
1483
</td>
<td style="text-align:left;">
2843
</td>
<td style="text-align:left;">
1.06
</td>
<td style="text-align:left;">
14.97
</td>
<td style="text-align:left;">
-91
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
5
</td>
<td style="text-align:left;">
▁▁▁▁▁▁▁▇
</td>
<td style="text-align:left;">
F8.2
</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (show_missings) {
  <span class="kw">plot_labelled</span>(missings, item_name, wrap_at)
}</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(item_info)) {
  <span class="co"># don&#39;t show choices again, if they&#39;re basically same thing as value labels</span>
  <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.null</span>(item_info<span class="op">$</span>choices) <span class="op">&amp;&amp;</span><span class="st"> </span>
<span class="st">    </span><span class="kw">all</span>(<span class="kw">names</span>(<span class="kw">na.omit</span>(choices)) <span class="op">==</span><span class="st"> </span>item_info<span class="op">$</span>choices) <span class="op">&amp;&amp;</span>
<span class="st">    </span><span class="kw">all</span>(<span class="kw">na.omit</span>(choices) <span class="op">==</span><span class="st"> </span><span class="kw">names</span>(item_info<span class="op">$</span>choices))) {
    item_info<span class="op">$</span>choices &lt;-<span class="st"> </span><span class="ot">NULL</span>
  }
  item_info<span class="op">$</span>label_parsed &lt;-<span class="st"> </span>
<span class="st">    </span>item_info<span class="op">$</span>choice_list &lt;-<span class="st"> </span>item_info<span class="op">$</span>study_id &lt;-<span class="st"> </span>item_info<span class="op">$</span>id &lt;-<span class="st"> </span><span class="ot">NULL</span>
  pander<span class="op">::</span><span class="kw">pander</span>(item_info)
}</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">length</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">length</span>(choices) <span class="op">&lt;</span><span class="st"> </span><span class="dv">30</span>) {
    pander<span class="op">::</span><span class="kw">pander</span>(<span class="kw">as.list</span>(choices))
}</code></pre></div>
</div>
</div>
<div id="r13pad7b" class="section level3 tabset">
<h3><span class="header-section-number">3.1.14</span> r13pad7b</h3>
<div id="r13pad7b_distribution" class="section level4">
<h4><span class="header-section-number">3.1.14.1</span> Distribution</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">show_missings &lt;-<span class="st"> </span><span class="ot">FALSE</span>
<span class="cf">if</span> (<span class="kw">has_label</span>(item)) {
  missings &lt;-<span class="st"> </span>item[<span class="kw">is.na</span>(haven<span class="op">::</span><span class="kw">zap_missing</span>(item))]
  <span class="kw">attributes</span>(missings) &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)
  <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(<span class="kw">attributes</span>(item)<span class="op">$</span>labels)) {
    <span class="kw">attributes</span>(missings)<span class="op">$</span>labels &lt;-<span class="st"> </span><span class="kw">attributes</span>(missings)<span class="op">$</span>labels[<span class="kw">is.na</span>(<span class="kw">attributes</span>(missings)<span class="op">$</span>labels)]
    <span class="kw">attributes</span>(item)<span class="op">$</span>labels &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)<span class="op">$</span>labels[<span class="op">!</span><span class="kw">is.na</span>(<span class="kw">attributes</span>(item)<span class="op">$</span>labels)]
  }
  <span class="cf">if</span> (<span class="kw">is.numeric</span>(item)) {
    show_missings &lt;-<span class="st"> </span><span class="kw">length</span>(<span class="kw">unique</span>(haven<span class="op">::</span><span class="kw">na_tag</span>(missings))) <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>
    item &lt;-<span class="st"> </span>haven<span class="op">::</span><span class="kw">zap_missing</span>(item)
  }
  <span class="cf">if</span> (<span class="kw">length</span>(item_attributes<span class="op">$</span>labels) <span class="op">==</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">is.numeric</span>(item)) {
    item &lt;-<span class="st"> </span>haven<span class="op">::</span><span class="kw">zap_labels</span>(item)
  }
}
item_nomiss &lt;-<span class="st"> </span>item[<span class="op">!</span><span class="kw">is.na</span>(item)]

<span class="co"># unnest mc_multiple and so on</span>
<span class="cf">if</span> (
  <span class="kw">is.character</span>(item_nomiss) <span class="op">&amp;&amp;</span>
<span class="st">  </span>stringr<span class="op">::</span><span class="kw">str_detect</span>(item_nomiss, stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;, &quot;</span>)) <span class="op">&amp;&amp;</span>
<span class="st">  </span>(<span class="kw">exists</span>(<span class="st">&quot;type&quot;</span>, item_info) <span class="op">&amp;&amp;</span><span class="st"> </span>
<span class="st">    </span>stringr<span class="op">::</span><span class="kw">str_detect</span>(item_info<span class="op">$</span>type, <span class="dt">pattern =</span> stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;multiple&quot;</span>)))
  ) {
  item_nomiss &lt;-<span class="st"> </span><span class="kw">unlist</span>(stringr<span class="op">::</span><span class="kw">str_split</span>(item_nomiss, <span class="dt">pattern =</span> stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;, &quot;</span>)))
}
<span class="kw">attributes</span>(item_nomiss) &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)

old_height &lt;-<span class="st"> </span>knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;fig.height&quot;</span>)
non_missing_choices &lt;-<span class="st"> </span>item_attributes[[<span class="st">&quot;labels&quot;</span>]]
many_labels &lt;-<span class="st"> </span><span class="kw">length</span>(non_missing_choices) <span class="op">&gt;</span><span class="st"> </span><span class="dv">7</span>
go_vertical &lt;-<span class="st"> </span><span class="op">!</span><span class="kw">is.numeric</span>(item_nomiss) <span class="op">||</span><span class="st"> </span>many_labels
<span class="cf">if</span> ( go_vertical ) {
  <span class="co"># numeric items are plotted horizontally (because that&#39;s what usually expected)</span>
  <span class="co"># categorical items are plotted vertically because we can use the screen real estate better this way</span>

    <span class="cf">if</span> (<span class="kw">is.null</span>(choices) <span class="op">||</span><span class="st"> </span>
<span class="st">        </span>dplyr<span class="op">::</span><span class="kw">n_distinct</span>(item_nomiss) <span class="op">&gt;</span><span class="st"> </span><span class="kw">length</span>(non_missing_choices)) {
        non_missing_choices &lt;-<span class="st"> </span><span class="kw">unique</span>(item_nomiss)
        <span class="kw">names</span>(non_missing_choices) &lt;-<span class="st"> </span>non_missing_choices
    }
  choice_multiplier &lt;-<span class="st"> </span>old_height<span class="op">/</span><span class="fl">6.5</span>
    new_height &lt;-<span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>choice_multiplier <span class="op">*</span><span class="st"> </span><span class="kw">length</span>(non_missing_choices)
    new_height &lt;-<span class="st"> </span><span class="kw">ifelse</span>(new_height <span class="op">&gt;</span><span class="st"> </span><span class="dv">20</span>, <span class="dv">20</span>, new_height)
    new_height &lt;-<span class="st"> </span><span class="kw">ifelse</span>(new_height <span class="op">&lt;</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">1</span>, new_height)
    knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">fig.height =</span> new_height)
}

wrap_at &lt;-<span class="st"> </span>knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;fig.width&quot;</span>) <span class="op">*</span><span class="st"> </span><span class="dv">10</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># todo: if there are free-text choices mingled in with the pre-defined ones, don&#39;t show</span>
<span class="co"># todo: show rare items if they are pre-defined</span>
<span class="co"># todo: bin rare responses into &quot;other category&quot;</span>
<span class="cf">if</span> (<span class="op">!</span><span class="kw">length</span>(item_nomiss)) {
  <span class="kw">cat</span>(<span class="st">&quot;No non-missing values to show.&quot;</span>)
} <span class="cf">else</span> <span class="cf">if</span> (<span class="kw">is.numeric</span>(item_nomiss) <span class="op">||</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">n_distinct</span>(item_nomiss) <span class="op">&lt;</span><span class="st"> </span><span class="dv">20</span>) {
  <span class="kw">plot_labelled</span>(item_nomiss, item_name, wrap_at, go_vertical)
} <span class="cf">else</span> {
    <span class="kw">cat</span>(dplyr<span class="op">::</span><span class="kw">n_distinct</span>(item_nomiss), <span class="st">&quot; unique, categorical values, so not shown.&quot;</span>)
}</code></pre></div>
<p><img src="Bookdown-goodloser_files/figure-html/r13pad7b_distribution-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">fig.height =</span> old_height)</code></pre></div>
<p>1483 missings.</p>
</div>
<div id="r13pad7b_summary" class="section level4">
<h4><span class="header-section-number">3.1.14.2</span> Summary statistics</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">attributes</span>(item) &lt;-<span class="st"> </span>item_attributes
df =<span class="st"> </span><span class="kw">data.frame</span>(item, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)
<span class="kw">names</span>(df) =<span class="st"> </span>html_item_name
<span class="kw">escaped_table</span>(<span class="kw">codebook_table</span>(df))</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
name
</th>
<th style="text-align:left;">
data_type
</th>
<th style="text-align:left;">
missing
</th>
<th style="text-align:left;">
complete
</th>
<th style="text-align:left;">
n
</th>
<th style="text-align:left;">
mean
</th>
<th style="text-align:left;">
sd
</th>
<th style="text-align:left;">
p0
</th>
<th style="text-align:left;">
p25
</th>
<th style="text-align:left;">
p50
</th>
<th style="text-align:left;">
p75
</th>
<th style="text-align:left;">
p100
</th>
<th style="text-align:left;">
hist
</th>
<th style="text-align:left;">
format.spss
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
r13pad7b
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:left;">
1483
</td>
<td style="text-align:left;">
1360
</td>
<td style="text-align:left;">
2843
</td>
<td style="text-align:left;">
1.38
</td>
<td style="text-align:left;">
14.62
</td>
<td style="text-align:left;">
-91
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
5
</td>
<td style="text-align:left;">
5
</td>
<td style="text-align:left;">
▁▁▁▁▁▁▁▇
</td>
<td style="text-align:left;">
F8.2
</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (show_missings) {
  <span class="kw">plot_labelled</span>(missings, item_name, wrap_at)
}</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(item_info)) {
  <span class="co"># don&#39;t show choices again, if they&#39;re basically same thing as value labels</span>
  <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.null</span>(item_info<span class="op">$</span>choices) <span class="op">&amp;&amp;</span><span class="st"> </span>
<span class="st">    </span><span class="kw">all</span>(<span class="kw">names</span>(<span class="kw">na.omit</span>(choices)) <span class="op">==</span><span class="st"> </span>item_info<span class="op">$</span>choices) <span class="op">&amp;&amp;</span>
<span class="st">    </span><span class="kw">all</span>(<span class="kw">na.omit</span>(choices) <span class="op">==</span><span class="st"> </span><span class="kw">names</span>(item_info<span class="op">$</span>choices))) {
    item_info<span class="op">$</span>choices &lt;-<span class="st"> </span><span class="ot">NULL</span>
  }
  item_info<span class="op">$</span>label_parsed &lt;-<span class="st"> </span>
<span class="st">    </span>item_info<span class="op">$</span>choice_list &lt;-<span class="st"> </span>item_info<span class="op">$</span>study_id &lt;-<span class="st"> </span>item_info<span class="op">$</span>id &lt;-<span class="st"> </span><span class="ot">NULL</span>
  pander<span class="op">::</span><span class="kw">pander</span>(item_info)
}</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">length</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">length</span>(choices) <span class="op">&lt;</span><span class="st"> </span><span class="dv">30</span>) {
    pander<span class="op">::</span><span class="kw">pander</span>(<span class="kw">as.list</span>(choices))
}</code></pre></div>
</div>
</div>
<div id="r13pad8a" class="section level3 tabset">
<h3><span class="header-section-number">3.1.15</span> r13pad8a</h3>
<div id="r13pad8a_distribution" class="section level4">
<h4><span class="header-section-number">3.1.15.1</span> Distribution</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">show_missings &lt;-<span class="st"> </span><span class="ot">FALSE</span>
<span class="cf">if</span> (<span class="kw">has_label</span>(item)) {
  missings &lt;-<span class="st"> </span>item[<span class="kw">is.na</span>(haven<span class="op">::</span><span class="kw">zap_missing</span>(item))]
  <span class="kw">attributes</span>(missings) &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)
  <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(<span class="kw">attributes</span>(item)<span class="op">$</span>labels)) {
    <span class="kw">attributes</span>(missings)<span class="op">$</span>labels &lt;-<span class="st"> </span><span class="kw">attributes</span>(missings)<span class="op">$</span>labels[<span class="kw">is.na</span>(<span class="kw">attributes</span>(missings)<span class="op">$</span>labels)]
    <span class="kw">attributes</span>(item)<span class="op">$</span>labels &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)<span class="op">$</span>labels[<span class="op">!</span><span class="kw">is.na</span>(<span class="kw">attributes</span>(item)<span class="op">$</span>labels)]
  }
  <span class="cf">if</span> (<span class="kw">is.numeric</span>(item)) {
    show_missings &lt;-<span class="st"> </span><span class="kw">length</span>(<span class="kw">unique</span>(haven<span class="op">::</span><span class="kw">na_tag</span>(missings))) <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>
    item &lt;-<span class="st"> </span>haven<span class="op">::</span><span class="kw">zap_missing</span>(item)
  }
  <span class="cf">if</span> (<span class="kw">length</span>(item_attributes<span class="op">$</span>labels) <span class="op">==</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">is.numeric</span>(item)) {
    item &lt;-<span class="st"> </span>haven<span class="op">::</span><span class="kw">zap_labels</span>(item)
  }
}
item_nomiss &lt;-<span class="st"> </span>item[<span class="op">!</span><span class="kw">is.na</span>(item)]

<span class="co"># unnest mc_multiple and so on</span>
<span class="cf">if</span> (
  <span class="kw">is.character</span>(item_nomiss) <span class="op">&amp;&amp;</span>
<span class="st">  </span>stringr<span class="op">::</span><span class="kw">str_detect</span>(item_nomiss, stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;, &quot;</span>)) <span class="op">&amp;&amp;</span>
<span class="st">  </span>(<span class="kw">exists</span>(<span class="st">&quot;type&quot;</span>, item_info) <span class="op">&amp;&amp;</span><span class="st"> </span>
<span class="st">    </span>stringr<span class="op">::</span><span class="kw">str_detect</span>(item_info<span class="op">$</span>type, <span class="dt">pattern =</span> stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;multiple&quot;</span>)))
  ) {
  item_nomiss &lt;-<span class="st"> </span><span class="kw">unlist</span>(stringr<span class="op">::</span><span class="kw">str_split</span>(item_nomiss, <span class="dt">pattern =</span> stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;, &quot;</span>)))
}
<span class="kw">attributes</span>(item_nomiss) &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)

old_height &lt;-<span class="st"> </span>knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;fig.height&quot;</span>)
non_missing_choices &lt;-<span class="st"> </span>item_attributes[[<span class="st">&quot;labels&quot;</span>]]
many_labels &lt;-<span class="st"> </span><span class="kw">length</span>(non_missing_choices) <span class="op">&gt;</span><span class="st"> </span><span class="dv">7</span>
go_vertical &lt;-<span class="st"> </span><span class="op">!</span><span class="kw">is.numeric</span>(item_nomiss) <span class="op">||</span><span class="st"> </span>many_labels
<span class="cf">if</span> ( go_vertical ) {
  <span class="co"># numeric items are plotted horizontally (because that&#39;s what usually expected)</span>
  <span class="co"># categorical items are plotted vertically because we can use the screen real estate better this way</span>

    <span class="cf">if</span> (<span class="kw">is.null</span>(choices) <span class="op">||</span><span class="st"> </span>
<span class="st">        </span>dplyr<span class="op">::</span><span class="kw">n_distinct</span>(item_nomiss) <span class="op">&gt;</span><span class="st"> </span><span class="kw">length</span>(non_missing_choices)) {
        non_missing_choices &lt;-<span class="st"> </span><span class="kw">unique</span>(item_nomiss)
        <span class="kw">names</span>(non_missing_choices) &lt;-<span class="st"> </span>non_missing_choices
    }
  choice_multiplier &lt;-<span class="st"> </span>old_height<span class="op">/</span><span class="fl">6.5</span>
    new_height &lt;-<span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>choice_multiplier <span class="op">*</span><span class="st"> </span><span class="kw">length</span>(non_missing_choices)
    new_height &lt;-<span class="st"> </span><span class="kw">ifelse</span>(new_height <span class="op">&gt;</span><span class="st"> </span><span class="dv">20</span>, <span class="dv">20</span>, new_height)
    new_height &lt;-<span class="st"> </span><span class="kw">ifelse</span>(new_height <span class="op">&lt;</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">1</span>, new_height)
    knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">fig.height =</span> new_height)
}

wrap_at &lt;-<span class="st"> </span>knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;fig.width&quot;</span>) <span class="op">*</span><span class="st"> </span><span class="dv">10</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># todo: if there are free-text choices mingled in with the pre-defined ones, don&#39;t show</span>
<span class="co"># todo: show rare items if they are pre-defined</span>
<span class="co"># todo: bin rare responses into &quot;other category&quot;</span>
<span class="cf">if</span> (<span class="op">!</span><span class="kw">length</span>(item_nomiss)) {
  <span class="kw">cat</span>(<span class="st">&quot;No non-missing values to show.&quot;</span>)
} <span class="cf">else</span> <span class="cf">if</span> (<span class="kw">is.numeric</span>(item_nomiss) <span class="op">||</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">n_distinct</span>(item_nomiss) <span class="op">&lt;</span><span class="st"> </span><span class="dv">20</span>) {
  <span class="kw">plot_labelled</span>(item_nomiss, item_name, wrap_at, go_vertical)
} <span class="cf">else</span> {
    <span class="kw">cat</span>(dplyr<span class="op">::</span><span class="kw">n_distinct</span>(item_nomiss), <span class="st">&quot; unique, categorical values, so not shown.&quot;</span>)
}</code></pre></div>
<p><img src="Bookdown-goodloser_files/figure-html/r13pad8a_distribution-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">fig.height =</span> old_height)</code></pre></div>
<p>1360 missings.</p>
</div>
<div id="r13pad8a_summary" class="section level4">
<h4><span class="header-section-number">3.1.15.2</span> Summary statistics</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">attributes</span>(item) &lt;-<span class="st"> </span>item_attributes
df =<span class="st"> </span><span class="kw">data.frame</span>(item, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)
<span class="kw">names</span>(df) =<span class="st"> </span>html_item_name
<span class="kw">escaped_table</span>(<span class="kw">codebook_table</span>(df))</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
name
</th>
<th style="text-align:left;">
data_type
</th>
<th style="text-align:left;">
missing
</th>
<th style="text-align:left;">
complete
</th>
<th style="text-align:left;">
n
</th>
<th style="text-align:left;">
mean
</th>
<th style="text-align:left;">
sd
</th>
<th style="text-align:left;">
p0
</th>
<th style="text-align:left;">
p25
</th>
<th style="text-align:left;">
p50
</th>
<th style="text-align:left;">
p75
</th>
<th style="text-align:left;">
p100
</th>
<th style="text-align:left;">
hist
</th>
<th style="text-align:left;">
format.spss
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
r13pad8a
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:left;">
1360
</td>
<td style="text-align:left;">
1483
</td>
<td style="text-align:left;">
2843
</td>
<td style="text-align:left;">
1.71
</td>
<td style="text-align:left;">
13.81
</td>
<td style="text-align:left;">
-91
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
5
</td>
<td style="text-align:left;">
▁▁▁▁▁▁▁▇
</td>
<td style="text-align:left;">
F8.2
</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (show_missings) {
  <span class="kw">plot_labelled</span>(missings, item_name, wrap_at)
}</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(item_info)) {
  <span class="co"># don&#39;t show choices again, if they&#39;re basically same thing as value labels</span>
  <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.null</span>(item_info<span class="op">$</span>choices) <span class="op">&amp;&amp;</span><span class="st"> </span>
<span class="st">    </span><span class="kw">all</span>(<span class="kw">names</span>(<span class="kw">na.omit</span>(choices)) <span class="op">==</span><span class="st"> </span>item_info<span class="op">$</span>choices) <span class="op">&amp;&amp;</span>
<span class="st">    </span><span class="kw">all</span>(<span class="kw">na.omit</span>(choices) <span class="op">==</span><span class="st"> </span><span class="kw">names</span>(item_info<span class="op">$</span>choices))) {
    item_info<span class="op">$</span>choices &lt;-<span class="st"> </span><span class="ot">NULL</span>
  }
  item_info<span class="op">$</span>label_parsed &lt;-<span class="st"> </span>
<span class="st">    </span>item_info<span class="op">$</span>choice_list &lt;-<span class="st"> </span>item_info<span class="op">$</span>study_id &lt;-<span class="st"> </span>item_info<span class="op">$</span>id &lt;-<span class="st"> </span><span class="ot">NULL</span>
  pander<span class="op">::</span><span class="kw">pander</span>(item_info)
}</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">length</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">length</span>(choices) <span class="op">&lt;</span><span class="st"> </span><span class="dv">30</span>) {
    pander<span class="op">::</span><span class="kw">pander</span>(<span class="kw">as.list</span>(choices))
}</code></pre></div>
</div>
</div>
<div id="r13pad8b" class="section level3 tabset">
<h3><span class="header-section-number">3.1.16</span> r13pad8b</h3>
<div id="r13pad8b_distribution" class="section level4">
<h4><span class="header-section-number">3.1.16.1</span> Distribution</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">show_missings &lt;-<span class="st"> </span><span class="ot">FALSE</span>
<span class="cf">if</span> (<span class="kw">has_label</span>(item)) {
  missings &lt;-<span class="st"> </span>item[<span class="kw">is.na</span>(haven<span class="op">::</span><span class="kw">zap_missing</span>(item))]
  <span class="kw">attributes</span>(missings) &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)
  <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(<span class="kw">attributes</span>(item)<span class="op">$</span>labels)) {
    <span class="kw">attributes</span>(missings)<span class="op">$</span>labels &lt;-<span class="st"> </span><span class="kw">attributes</span>(missings)<span class="op">$</span>labels[<span class="kw">is.na</span>(<span class="kw">attributes</span>(missings)<span class="op">$</span>labels)]
    <span class="kw">attributes</span>(item)<span class="op">$</span>labels &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)<span class="op">$</span>labels[<span class="op">!</span><span class="kw">is.na</span>(<span class="kw">attributes</span>(item)<span class="op">$</span>labels)]
  }
  <span class="cf">if</span> (<span class="kw">is.numeric</span>(item)) {
    show_missings &lt;-<span class="st"> </span><span class="kw">length</span>(<span class="kw">unique</span>(haven<span class="op">::</span><span class="kw">na_tag</span>(missings))) <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>
    item &lt;-<span class="st"> </span>haven<span class="op">::</span><span class="kw">zap_missing</span>(item)
  }
  <span class="cf">if</span> (<span class="kw">length</span>(item_attributes<span class="op">$</span>labels) <span class="op">==</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">is.numeric</span>(item)) {
    item &lt;-<span class="st"> </span>haven<span class="op">::</span><span class="kw">zap_labels</span>(item)
  }
}
item_nomiss &lt;-<span class="st"> </span>item[<span class="op">!</span><span class="kw">is.na</span>(item)]

<span class="co"># unnest mc_multiple and so on</span>
<span class="cf">if</span> (
  <span class="kw">is.character</span>(item_nomiss) <span class="op">&amp;&amp;</span>
<span class="st">  </span>stringr<span class="op">::</span><span class="kw">str_detect</span>(item_nomiss, stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;, &quot;</span>)) <span class="op">&amp;&amp;</span>
<span class="st">  </span>(<span class="kw">exists</span>(<span class="st">&quot;type&quot;</span>, item_info) <span class="op">&amp;&amp;</span><span class="st"> </span>
<span class="st">    </span>stringr<span class="op">::</span><span class="kw">str_detect</span>(item_info<span class="op">$</span>type, <span class="dt">pattern =</span> stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;multiple&quot;</span>)))
  ) {
  item_nomiss &lt;-<span class="st"> </span><span class="kw">unlist</span>(stringr<span class="op">::</span><span class="kw">str_split</span>(item_nomiss, <span class="dt">pattern =</span> stringr<span class="op">::</span><span class="kw">fixed</span>(<span class="st">&quot;, &quot;</span>)))
}
<span class="kw">attributes</span>(item_nomiss) &lt;-<span class="st"> </span><span class="kw">attributes</span>(item)

old_height &lt;-<span class="st"> </span>knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;fig.height&quot;</span>)
non_missing_choices &lt;-<span class="st"> </span>item_attributes[[<span class="st">&quot;labels&quot;</span>]]
many_labels &lt;-<span class="st"> </span><span class="kw">length</span>(non_missing_choices) <span class="op">&gt;</span><span class="st"> </span><span class="dv">7</span>
go_vertical &lt;-<span class="st"> </span><span class="op">!</span><span class="kw">is.numeric</span>(item_nomiss) <span class="op">||</span><span class="st"> </span>many_labels
<span class="cf">if</span> ( go_vertical ) {
  <span class="co"># numeric items are plotted horizontally (because that&#39;s what usually expected)</span>
  <span class="co"># categorical items are plotted vertically because we can use the screen real estate better this way</span>

    <span class="cf">if</span> (<span class="kw">is.null</span>(choices) <span class="op">||</span><span class="st"> </span>
<span class="st">        </span>dplyr<span class="op">::</span><span class="kw">n_distinct</span>(item_nomiss) <span class="op">&gt;</span><span class="st"> </span><span class="kw">length</span>(non_missing_choices)) {
        non_missing_choices &lt;-<span class="st"> </span><span class="kw">unique</span>(item_nomiss)
        <span class="kw">names</span>(non_missing_choices) &lt;-<span class="st"> </span>non_missing_choices
    }
  choice_multiplier &lt;-<span class="st"> </span>old_height<span class="op">/</span><span class="fl">6.5</span>
    new_height &lt;-<span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>choice_multiplier <span class="op">*</span><span class="st"> </span><span class="kw">length</span>(non_missing_choices)
    new_height &lt;-<span class="st"> </span><span class="kw">ifelse</span>(new_height <span class="op">&gt;</span><span class="st"> </span><span class="dv">20</span>, <span class="dv">20</span>, new_height)
    new_height &lt;-<span class="st"> </span><span class="kw">ifelse</span>(new_height <span class="op">&lt;</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">1</span>, new_height)
    knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">fig.height =</span> new_height)
}

wrap_at &lt;-<span class="st"> </span>knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;fig.width&quot;</span>) <span class="op">*</span><span class="st"> </span><span class="dv">10</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># todo: if there are free-text choices mingled in with the pre-defined ones, don&#39;t show</span>
<span class="co"># todo: show rare items if they are pre-defined</span>
<span class="co"># todo: bin rare responses into &quot;other category&quot;</span>
<span class="cf">if</span> (<span class="op">!</span><span class="kw">length</span>(item_nomiss)) {
  <span class="kw">cat</span>(<span class="st">&quot;No non-missing values to show.&quot;</span>)
} <span class="cf">else</span> <span class="cf">if</span> (<span class="kw">is.numeric</span>(item_nomiss) <span class="op">||</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">n_distinct</span>(item_nomiss) <span class="op">&lt;</span><span class="st"> </span><span class="dv">20</span>) {
  <span class="kw">plot_labelled</span>(item_nomiss, item_name, wrap_at, go_vertical)
} <span class="cf">else</span> {
    <span class="kw">cat</span>(dplyr<span class="op">::</span><span class="kw">n_distinct</span>(item_nomiss), <span class="st">&quot; unique, categorical values, so not shown.&quot;</span>)
}</code></pre></div>
<p><img src="Bookdown-goodloser_files/figure-html/r13pad8b_distribution-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">fig.height =</span> old_height)</code></pre></div>
<p>1483 missings.</p>
</div>
<div id="r13pad8b_summary" class="section level4">
<h4><span class="header-section-number">3.1.16.2</span> Summary statistics</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">attributes</span>(item) &lt;-<span class="st"> </span>item_attributes
df =<span class="st"> </span><span class="kw">data.frame</span>(item, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)
<span class="kw">names</span>(df) =<span class="st"> </span>html_item_name
<span class="kw">escaped_table</span>(<span class="kw">codebook_table</span>(df))</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
name
</th>
<th style="text-align:left;">
data_type
</th>
<th style="text-align:left;">
missing
</th>
<th style="text-align:left;">
complete
</th>
<th style="text-align:left;">
n
</th>
<th style="text-align:left;">
mean
</th>
<th style="text-align:left;">
sd
</th>
<th style="text-align:left;">
p0
</th>
<th style="text-align:left;">
p25
</th>
<th style="text-align:left;">
p50
</th>
<th style="text-align:left;">
p75
</th>
<th style="text-align:left;">
p100
</th>
<th style="text-align:left;">
hist
</th>
<th style="text-align:left;">
format.spss
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
r13pad8b
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:left;">
1483
</td>
<td style="text-align:left;">
1360
</td>
<td style="text-align:left;">
2843
</td>
<td style="text-align:left;">
2.1
</td>
<td style="text-align:left;">
13.3
</td>
<td style="text-align:left;">
-91
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
5
</td>
<td style="text-align:left;">
5
</td>
<td style="text-align:left;">
▁▁▁▁▁▁▁▇
</td>
<td style="text-align:left;">
F8.2
</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (show_missings) {
  <span class="kw">plot_labelled</span>(missings, item_name, wrap_at)
}</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(item_info)) {
  <span class="co"># don&#39;t show choices again, if they&#39;re basically same thing as value labels</span>
  <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.null</span>(item_info<span class="op">$</span>choices) <span class="op">&amp;&amp;</span><span class="st"> </span>
<span class="st">    </span><span class="kw">all</span>(<span class="kw">names</span>(<span class="kw">na.omit</span>(choices)) <span class="op">==</span><span class="st"> </span>item_info<span class="op">$</span>choices) <span class="op">&amp;&amp;</span>
<span class="st">    </span><span class="kw">all</span>(<span class="kw">na.omit</span>(choices) <span class="op">==</span><span class="st"> </span><span class="kw">names</span>(item_info<span class="op">$</span>choices))) {
    item_info<span class="op">$</span>choices &lt;-<span class="st"> </span><span class="ot">NULL</span>
  }
  item_info<span class="op">$</span>label_parsed &lt;-<span class="st"> </span>
<span class="st">    </span>item_info<span class="op">$</span>choice_list &lt;-<span class="st"> </span>item_info<span class="op">$</span>study_id &lt;-<span class="st"> </span>item_info<span class="op">$</span>id &lt;-<span class="st"> </span><span class="ot">NULL</span>
  pander<span class="op">::</span><span class="kw">pander</span>(item_info)
}</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">length</span>(choices) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">length</span>(choices) <span class="op">&lt;</span><span class="st"> </span><span class="dv">30</span>) {
    pander<span class="op">::</span><span class="kw">pander</span>(<span class="kw">as.list</span>(choices))
}</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">missingness_report</code></pre></div>
</div>
</div>
</div>
<div id="missingness-report" class="section level2">
<h2><span class="header-section-number">3.2</span> Missingness report</h2>
<p>Among those who finished the survey. Only variables that have missings are shown.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (  <span class="kw">exists</span>(<span class="st">&quot;ended&quot;</span>, results) <span class="op">&amp;&amp;</span>
<span class="st">  </span><span class="kw">exists</span>(<span class="st">&quot;expired&quot;</span>, results)) {
  finisher_results &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(results, <span class="op">!</span><span class="kw">is.na</span>(.data<span class="op">$</span>ended))
} <span class="cf">else</span> {
  finisher_results &lt;-<span class="st"> </span>results
  <span class="kw">warning</span>(<span class="st">&quot;Could not figure out who finished the surveys, because the &quot;</span>,
          <span class="st">&quot;variables expired and ended were missing.&quot;</span>)
}</code></pre></div>
<pre><code>## Warning: Could not figure out who finished the surveys, because the
## variables expired and ended were missing.</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (<span class="kw">length</span>(md_pattern)) {
  pander<span class="op">::</span><span class="kw">pander</span>(md_pattern)
}</code></pre></div>
<table style="width:100%;">
<caption>Table continues below</caption>
<colgroup>
<col width="32%" />
<col width="13%" />
<col width="13%" />
<col width="13%" />
<col width="13%" />
<col width="13%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">description</th>
<th align="center">r13pad6a</th>
<th align="center">r13pad7a</th>
<th align="center">r13pad8a</th>
<th align="center">r13pad6b</th>
<th align="center">r13pad7b</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">Missings per variable</td>
<td align="center">1360</td>
<td align="center">1360</td>
<td align="center">1360</td>
<td align="center">1483</td>
<td align="center">1483</td>
</tr>
<tr class="even">
<td align="center">Missings in 3 variables</td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td align="center">Missings in 3 variables</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">1</td>
</tr>
</tbody>
</table>
<table style="width:42%;">
<colgroup>
<col width="15%" />
<col width="15%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">r13pad8b</th>
<th align="center">var_miss</th>
<th align="center">n_miss</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">1483</td>
<td align="center">8529</td>
<td align="center">8529</td>
</tr>
<tr class="even">
<td align="center">0</td>
<td align="center">3</td>
<td align="center">1483</td>
</tr>
<tr class="odd">
<td align="center">1</td>
<td align="center">3</td>
<td align="center">1360</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">items</code></pre></div>
</div>
<div id="codebook-table" class="section level2">
<h2><span class="header-section-number">3.3</span> Codebook table</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">export_table</span>(metadata_table)</code></pre></div>
<div id="htmlwidget-a78b5d65cfdc6d96cbe3" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-a78b5d65cfdc6d96cbe3">{"x":{"filter":"top","filterHTML":"<tr>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"disabled\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","extensions":["Buttons"],"data":[["<a href=\"#r13pad1\">r13pad1<\/a>","<a href=\"#r13pad2\">r13pad2<\/a>","<a href=\"#r13pad3\">r13pad3<\/a>","<a href=\"#r13pad4\">r13pad4<\/a>","<a href=\"#r13pad5_avsender\">r13pad5_avsender<\/a>","<a href=\"#r13pad5_sak\">r13pad5_sak<\/a>","<a href=\"#r13pad5_utfall\">r13pad5_utfall<\/a>","<a href=\"#r13pad5_vinner\">r13pad5_vinner<\/a>","<a href=\"#r13pad5_vinnermargin\">r13pad5_vinnermargin<\/a>","<a href=\"#r13pad6_ran\">r13pad6_ran<\/a>","<a href=\"#r13pad6a\">r13pad6a<\/a>","<a href=\"#r13pad6b\">r13pad6b<\/a>","<a href=\"#r13pad7a\">r13pad7a<\/a>","<a href=\"#r13pad7b\">r13pad7b<\/a>","<a href=\"#r13pad8a\">r13pad8a<\/a>","<a href=\"#r13pad8b\">r13pad8b<\/a>"],["character","numeric","character","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric"],["0","0","0","0","0","0","0","0","0","0","1360","1483","1360","1483","1360","1483"],["2843","2843","2843","2843","2843","2843","2843","2843","2843","2843","1483","1360","1483","1360","1483","1360"],["2843","2843","2843","2843","2843","2843","2843","2843","2843","2843","2843","2843","2843","2843","2843","2843"],["2843",null,"2843",null,null,null,null,null,null,null,null,null,null,null,null,null],["1",null,"1",null,null,null,null,null,null,null,null,null,null,null,null,null],["0",null,"0",null,null,null,null,null,null,null,null,null,null,null,null,null],["0",null,"0",null,null,null,null,null,null,null,null,null,null,null,null,null],[null,"2.45",null,"2.76","4.02","1.5 ","1.5 ","1.51","1.99","1.48","1.71","2.45","1.06","1.38","1.71","2.1 "],[null," 5.91",null," 6.93"," 1.98"," 0.5 "," 0.5 "," 0.5 "," 0.82"," 0.5 ","14.02","12.31","14.97","14.62","13.81","13.3 "],[null,"-91",null,"-91","1","1","1","1","1","1","-91","-91","-91","-91","-91","-91"],[null,"2",null,"2","2","1","1","1","1","1","4","3","3","3","3","3"],[null,"3",null,"3","4","1","2","2","2","1","4","4","4","4","4","4"],[null,"3",null,"4","6","2","2","2","3","2","4","5","4","5","4","5"],[null,"5",null,"5","7","2","2","2","3","2","5","5","5","5","5","5"],[null,"▁▁▁▁▁▁▁▇",null,"▁▁▁▁▁▁▁▇","▇▇▇▇▁▇▇▇","▇▁▁▁▁▁▁▇","▇▁▁▁▁▁▁▇","▇▁▁▁▁▁▁▇","▇▁▁▇▁▁▁▇","▇▁▁▁▁▁▁▇","▁▁▁▁▁▁▁▇","▁▁▁▁▁▁▁▇","▁▁▁▁▁▁▁▇","▁▁▁▁▁▁▁▇","▁▁▁▁▁▁▁▇","▁▁▁▁▁▁▁▇"],["A2","F8.2","A2","F8.2","F8.2","F8.2","F8.2","F8.2","F8.2","F8.2","F8.2","F8.2","F8.2","F8.2","F8.2","F8.2"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>name<\/th>\n      <th>data_type<\/th>\n      <th>missing<\/th>\n      <th>complete<\/th>\n      <th>n<\/th>\n      <th>empty<\/th>\n      <th>n_unique<\/th>\n      <th>min<\/th>\n      <th>max<\/th>\n      <th>mean<\/th>\n      <th>sd<\/th>\n      <th>p0<\/th>\n      <th>p25<\/th>\n      <th>p50<\/th>\n      <th>p75<\/th>\n      <th>p100<\/th>\n      <th>hist<\/th>\n      <th>format.spss<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"Bfrtip","buttons":["copy","csv","excel","pdf","print"],"pageLength":200,"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true,"lengthMenu":[10,25,50,100,200]}},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">jsonld</code></pre></div>
<script type="application/ld+json">
{
  "name": "results",
  "keywords": ["r13pad1", "r13pad2", "r13pad3", "r13pad4", "r13pad5_avsender", "r13pad5_sak", "r13pad5_utfall", "r13pad5_vinner", "r13pad5_vinnermargin", "r13pad6_ran", "r13pad6a", "r13pad6b", "r13pad7a", "r13pad7b", "r13pad8a", "r13pad8b"],
  "variableMeasured": [
    {
      "format.spss": "A2",
      "name": "r13pad1",
      "data_summary": [
        {
          "missing": "0",
          "complete": "2843",
          "n": "2843",
          "min": "0",
          "max": "0",
          "empty": "2843",
          "n_unique": "1",
          "@type": "http://formr.org/codebook/SummaryStatistics"
        }
      ],
      "value": "text",
      "@context": {
        "@vocab": "http://pending.schema.org/"
      },
      "@type": "propertyValue"
    },
    {
      "format.spss": "F8.2",
      "name": "r13pad2",
      "data_summary": [
        {
          "missing": "0",
          "complete": "2843",
          "n": "2843",
          "mean": "2.45",
          "sd": "5.91",
          "p0": "-91",
          "p25": "2",
          "p50": "3",
          "p75": "3",
          "p100": "5",
          "hist": "▁▁▁▁▁▁▁▇",
          "@type": "http://formr.org/codebook/SummaryStatistics"
        }
      ],
      "value": "Number",
      "@context": {
        "@vocab": "http://pending.schema.org/"
      },
      "@type": "propertyValue"
    },
    {
      "format.spss": "A2",
      "name": "r13pad3",
      "data_summary": [
        {
          "missing": "0",
          "complete": "2843",
          "n": "2843",
          "min": "0",
          "max": "0",
          "empty": "2843",
          "n_unique": "1",
          "@type": "http://formr.org/codebook/SummaryStatistics"
        }
      ],
      "value": "text",
      "@context": {
        "@vocab": "http://pending.schema.org/"
      },
      "@type": "propertyValue"
    },
    {
      "format.spss": "F8.2",
      "name": "r13pad4",
      "data_summary": [
        {
          "missing": "0",
          "complete": "2843",
          "n": "2843",
          "mean": "2.76",
          "sd": "6.93",
          "p0": "-91",
          "p25": "2",
          "p50": "3",
          "p75": "4",
          "p100": "5",
          "hist": "▁▁▁▁▁▁▁▇",
          "@type": "http://formr.org/codebook/SummaryStatistics"
        }
      ],
      "value": "Number",
      "@context": {
        "@vocab": "http://pending.schema.org/"
      },
      "@type": "propertyValue"
    },
    {
      "format.spss": "F8.2",
      "name": "r13pad5_avsender",
      "data_summary": [
        {
          "missing": "0",
          "complete": "2843",
          "n": "2843",
          "mean": "4.02",
          "sd": "1.98",
          "p0": "1",
          "p25": "2",
          "p50": "4",
          "p75": "6",
          "p100": "7",
          "hist": "▇▇▇▇▁▇▇▇",
          "@type": "http://formr.org/codebook/SummaryStatistics"
        }
      ],
      "value": "Number",
      "@context": {
        "@vocab": "http://pending.schema.org/"
      },
      "@type": "propertyValue"
    },
    {
      "format.spss": "F8.2",
      "name": "r13pad5_sak",
      "data_summary": [
        {
          "missing": "0",
          "complete": "2843",
          "n": "2843",
          "mean": "1.5",
          "sd": "0.5",
          "p0": "1",
          "p25": "1",
          "p50": "1",
          "p75": "2",
          "p100": "2",
          "hist": "▇▁▁▁▁▁▁▇",
          "@type": "http://formr.org/codebook/SummaryStatistics"
        }
      ],
      "value": "Number",
      "@context": {
        "@vocab": "http://pending.schema.org/"
      },
      "@type": "propertyValue"
    },
    {
      "format.spss": "F8.2",
      "name": "r13pad5_utfall",
      "data_summary": [
        {
          "missing": "0",
          "complete": "2843",
          "n": "2843",
          "mean": "1.5",
          "sd": "0.5",
          "p0": "1",
          "p25": "1",
          "p50": "2",
          "p75": "2",
          "p100": "2",
          "hist": "▇▁▁▁▁▁▁▇",
          "@type": "http://formr.org/codebook/SummaryStatistics"
        }
      ],
      "value": "Number",
      "@context": {
        "@vocab": "http://pending.schema.org/"
      },
      "@type": "propertyValue"
    },
    {
      "format.spss": "F8.2",
      "name": "r13pad5_vinner",
      "data_summary": [
        {
          "missing": "0",
          "complete": "2843",
          "n": "2843",
          "mean": "1.51",
          "sd": "0.5",
          "p0": "1",
          "p25": "1",
          "p50": "2",
          "p75": "2",
          "p100": "2",
          "hist": "▇▁▁▁▁▁▁▇",
          "@type": "http://formr.org/codebook/SummaryStatistics"
        }
      ],
      "value": "Number",
      "@context": {
        "@vocab": "http://pending.schema.org/"
      },
      "@type": "propertyValue"
    },
    {
      "format.spss": "F8.2",
      "name": "r13pad5_vinnermargin",
      "data_summary": [
        {
          "missing": "0",
          "complete": "2843",
          "n": "2843",
          "mean": "1.99",
          "sd": "0.82",
          "p0": "1",
          "p25": "1",
          "p50": "2",
          "p75": "3",
          "p100": "3",
          "hist": "▇▁▁▇▁▁▁▇",
          "@type": "http://formr.org/codebook/SummaryStatistics"
        }
      ],
      "value": "Number",
      "@context": {
        "@vocab": "http://pending.schema.org/"
      },
      "@type": "propertyValue"
    },
    {
      "format.spss": "F8.2",
      "name": "r13pad6_ran",
      "data_summary": [
        {
          "missing": "0",
          "complete": "2843",
          "n": "2843",
          "mean": "1.48",
          "sd": "0.5",
          "p0": "1",
          "p25": "1",
          "p50": "1",
          "p75": "2",
          "p100": "2",
          "hist": "▇▁▁▁▁▁▁▇",
          "@type": "http://formr.org/codebook/SummaryStatistics"
        }
      ],
      "value": "Number",
      "@context": {
        "@vocab": "http://pending.schema.org/"
      },
      "@type": "propertyValue"
    },
    {
      "format.spss": "F8.2",
      "name": "r13pad6a",
      "data_summary": [
        {
          "missing": "1360",
          "complete": "1483",
          "n": "2843",
          "mean": "1.71",
          "sd": "14.02",
          "p0": "-91",
          "p25": "4",
          "p50": "4",
          "p75": "4",
          "p100": "5",
          "hist": "▁▁▁▁▁▁▁▇",
          "@type": "http://formr.org/codebook/SummaryStatistics"
        }
      ],
      "value": "Number",
      "@context": {
        "@vocab": "http://pending.schema.org/"
      },
      "@type": "propertyValue"
    },
    {
      "format.spss": "F8.2",
      "name": "r13pad6b",
      "data_summary": [
        {
          "missing": "1483",
          "complete": "1360",
          "n": "2843",
          "mean": "2.45",
          "sd": "12.31",
          "p0": "-91",
          "p25": "3",
          "p50": "4",
          "p75": "5",
          "p100": "5",
          "hist": "▁▁▁▁▁▁▁▇",
          "@type": "http://formr.org/codebook/SummaryStatistics"
        }
      ],
      "value": "Number",
      "@context": {
        "@vocab": "http://pending.schema.org/"
      },
      "@type": "propertyValue"
    },
    {
      "format.spss": "F8.2",
      "name": "r13pad7a",
      "data_summary": [
        {
          "missing": "1360",
          "complete": "1483",
          "n": "2843",
          "mean": "1.06",
          "sd": "14.97",
          "p0": "-91",
          "p25": "3",
          "p50": "4",
          "p75": "4",
          "p100": "5",
          "hist": "▁▁▁▁▁▁▁▇",
          "@type": "http://formr.org/codebook/SummaryStatistics"
        }
      ],
      "value": "Number",
      "@context": {
        "@vocab": "http://pending.schema.org/"
      },
      "@type": "propertyValue"
    },
    {
      "format.spss": "F8.2",
      "name": "r13pad7b",
      "data_summary": [
        {
          "missing": "1483",
          "complete": "1360",
          "n": "2843",
          "mean": "1.38",
          "sd": "14.62",
          "p0": "-91",
          "p25": "3",
          "p50": "4",
          "p75": "5",
          "p100": "5",
          "hist": "▁▁▁▁▁▁▁▇",
          "@type": "http://formr.org/codebook/SummaryStatistics"
        }
      ],
      "value": "Number",
      "@context": {
        "@vocab": "http://pending.schema.org/"
      },
      "@type": "propertyValue"
    },
    {
      "format.spss": "F8.2",
      "name": "r13pad8a",
      "data_summary": [
        {
          "missing": "1360",
          "complete": "1483",
          "n": "2843",
          "mean": "1.71",
          "sd": "13.81",
          "p0": "-91",
          "p25": "3",
          "p50": "4",
          "p75": "4",
          "p100": "5",
          "hist": "▁▁▁▁▁▁▁▇",
          "@type": "http://formr.org/codebook/SummaryStatistics"
        }
      ],
      "value": "Number",
      "@context": {
        "@vocab": "http://pending.schema.org/"
      },
      "@type": "propertyValue"
    },
    {
      "format.spss": "F8.2",
      "name": "r13pad8b",
      "data_summary": [
        {
          "missing": "1483",
          "complete": "1360",
          "n": "2843",
          "mean": "2.1",
          "sd": "13.3",
          "p0": "-91",
          "p25": "3",
          "p50": "4",
          "p75": "5",
          "p100": "5",
          "hist": "▁▁▁▁▁▁▁▇",
          "@type": "http://formr.org/codebook/SummaryStatistics"
        }
      ],
      "value": "Number",
      "@context": {
        "@vocab": "http://pending.schema.org/"
      },
      "@type": "propertyValue"
    }
  ],
  "@context": "http://schema.org/",
  "@type": "Dataset"
}
</script>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="create-data-set.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="methods.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": ["Bookdown-goodloser.pdf", "Bookdown-goodloser.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
